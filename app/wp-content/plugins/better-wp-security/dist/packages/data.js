this.itsec=this.itsec||{},this.itsec.packages=this.itsec.packages||{},this.itsec.packages.data=(window.itsecWebpackJsonP=window.itsecWebpackJsonP||[]).push([[21],{"/fTC":function(e,t,n){var r,i;r=function(){var e=/^;\s*([^"=]+)=(?:"([^"]+)"|([^";,]+)(?:[;,]|$))/,t=/^<([^>]*)>/,n=/^\s*,\s*/;return{parse:function(r,i){for(var s,u,o,c=i&&i.extended||!1,d=[];r&&(r=r.trim(),u=t.exec(r));){for(var l={link:u[1]},a=(r=r.slice(u[0].length)).match(n);r&&(!a||a.index>0)&&(s=e.exec(r));)a=(r=r.slice(s[0].length)).match(n),"rel"===s[1]||"rev"===s[1]?(o=(s[2]||s[3]).split(/\s+/),l[s[1]]=o):l[s[1]]=s[2]||s[3];d.push(l),r=r.replace(n,"")}return c?d:d.reduce((function(e,t){return t.rel&&t.rel.forEach((function(n){e[n]=t.link})),e}),{})},stringify:function(e){var t=Object.keys(e).reduce((function(t,n){return t[e[n]]=t[e[n]]||[],t[e[n]].push(n),t}),{});return Object.keys(t).reduce((function(e,n){return e.concat("<"+n+'>; rel="'+t[n].join(" ")+'"')}),[]).join(", ")}}},i=this,e.exports?e.exports=r():"function"==typeof i.define&&i.define.amd?define(r):i.li=r()},"1ZqX":function(e,t){!function(){e.exports=this.wp.data}()},GRId:function(e,t){!function(){e.exports=this.wp.element}()},Mmq9:function(e,t){!function(){e.exports=this.wp.url}()},Td6G:function(e,t,n){"use strict";n.d(t,"c",(function(){return E})),n.d(t,"b",(function(){return m})),n.d(t,"o",(function(){return b})),n.d(t,"m",(function(){return v})),n.d(t,"j",(function(){return _})),n.d(t,"e",(function(){return I})),n.d(t,"f",(function(){return T})),n.d(t,"d",(function(){return O})),n.d(t,"l",(function(){return A})),n.d(t,"a",(function(){return j})),n.d(t,"i",(function(){return R})),n.d(t,"h",(function(){return N})),n.d(t,"g",(function(){return C})),n.d(t,"k",(function(){return D})),n.d(t,"n",(function(){return M}));var r=n("YLtl"),i=n("GRId"),s=n("Mmq9"),u=n("lSNA"),o=n.n(u),c=n("92Nh"),d=n.n(c),l=n("tmk3"),a=n.n(l);function f(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}var g=new WeakMap,y=new WeakMap;class E{constructor(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;f(this,g,{writable:!0,value:{}}),f(this,y,{writable:!0,value:{}}),o()(this,"add",(e,t)=>(a()(this,g)[e]||(a()(this,g)[e]=[]),a()(this,g)[e].push(t),this)),o()(this,"hasErrors",()=>this.getErrorCodes().length>0),o()(this,"getErrorCodes",()=>Object.keys(a()(this,g))),o()(this,"getErrorCode",()=>this.getErrorCodes()[0]),o()(this,"getErrorMessages",(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(t)return a()(e,g)[t];const n=[];for(const t in a()(e,g))a()(e,g).hasOwnProperty(t)&&n.concat(a()(e,g)[t]);return n})),o()(this,"getErrorMessage",(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return t=t||e.getErrorCode(),e.getErrorMessages(t)[0]})),o()(this,"getErrorData",(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;return t=t||e.getErrorCode(),a()(e,y)[t]})),o()(this,"getAllErrorMessages",()=>{const e=[];for(const t in a()(this,g))a()(this,g).hasOwnProperty(t)&&e.push(...a()(this,g)[t]);return e}),t&&(n&&(a()(this,g)[t]=[n]),r&&(a()(this,y)[t]=r))}static fromPHPObject(e){const t=new E;return d()(t,g,e.errors),d()(t,y,e.error_data),t}static fromApiError(e){const t=new E;if(a()(t,g)[e.code]=[e.message],a()(t,y)[e.code]=e.data,e.additional_errors)for(const n of e.additional_errors)a()(t,g)[n.code]=[n.message],a()(t,y)[n.code]=n.data;return t}}var h=n("l3Sj");class p extends Error{constructor(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];super(e.message||Object(h.__)("An unknown error occurred.","better-wp-security"),...n),Error.captureStackTrace&&Error.captureStackTrace(this,p),this.__response=e;for(const t in e)e.hasOwnProperty(t)&&Object.defineProperty(this,t,{value:e[t],configurable:!0,enumerable:!0,writable:!0})}toString(){return this.__response.toString()}getResponse(){return this.__response}}n("LhCv");class m{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];o()(this,"type",void 0),o()(this,"error",void 0),o()(this,"data",void 0),o()(this,"success",void 0),o()(this,"info",void 0),o()(this,"warning",void 0),this.type=e,this.error=t,this.data=n,this.success=r,this.info=i,this.warning=s,Object.seal(this)}isSuccess(){return this.type===m.SUCCESS}static async fromResponse(e){const t=t=>{var n;const r=null===(n=e.headers)||void 0===n?void 0:n.get("X-Messages-"+t);return r?JSON.parse(r):[]},n=204!==e.status&&e.json?await e.json():null,r=I(n),i=r.hasErrors()?m.ERROR:m.SUCCESS,s=t("Success"),u=t("Info"),o=t("Warning");return new m(i,r,n,s,u,o)}}Object.defineProperty(m,"SUCCESS",{value:"success",writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(m,"ERROR",{value:"error",writable:!1,enumerable:!1,configurable:!1});const S=Object(i.createContext)({getUrl(e){e="settings"===e?"itsec":"itsec-"+e;const t=Object(s.removeQueryArgs)(document.location.href,...Object.keys(Object(s.getQueryArgs)(document.location.href)));return Object(s.addQueryArgs)(t,{page:e})}});function b(e){const{getUrl:t}=Object(i.useContext)(S);return t(e)}function v(e){if(e<=999)return e.toString();if(e<=9999){const t=(e/1e3).toFixed(1);return"0"===t.charAt(t.length-1)?t.replace(".0","k"):t+"k"}if(e<=99999)return e.toString().substring(0,2)+"k";if(e<=999999)return e.toString().substring(0,3)+"k";if(e<=9999999){const t=(e/1e6).toFixed(1);return"0"===t.charAt(t.length-1)?t.replace(".0","m"):t+"m"}if(e<=99999999)return e.toString().substring(0,2)+"m";if(e<=999999999)return e.toString().substring(0,3)+"m";if(e<=9999999999){const t=(e/1e9).toFixed(1);return"0"===t.charAt(t.length-1)?t.replace(".0","b"):t+"b"}return e}function _(e){if(!Object(r.isPlainObject)(e))return!1;const t=Object.keys(e);return 2===t.length&&(t.includes("errors")&&t.includes("error_data"))}function I(e){return e instanceof E?e:_(e)?E.fromPHPObject(e):function(e){if(!Object(r.isPlainObject)(e))return!1;const t=Object.keys(e);return(3===t.length||4===t.length)&&(!(4===t.length&&!t.includes("additional_errors"))&&(t.includes("code")&&t.includes("message")&&t.includes("data")))}(e)?E.fromApiError(e):new E}function T(e){const t={};for(const[n,r]of e)t[n]=r;return t}function O(e,t){const n=[[],[]];for(const r of e)n[t(r)?0:1].push(r);return n}function A(e){if(e instanceof Error)throw e;throw new p(e)}const j="https://secure.gravatar.com/avatar/d7a973c7dab26985da5f961be7b74480?s=96&d=mm&f=y&r=g";function R(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return Object(r.get)(e,["_links","self",0,"targetHints",t],n?void 0:[])}function N(e){return function(e,t){return Object(r.get)(e,["_links",t,0,"href"])}(e,"self")}function C(e,t){if(e&&e.links)for(const n of e.links)if(n.rel===t)return n}function D(e,t){if("object"!==e.type)return e;let n;for(const i in t)t.hasOwnProperty(i)&&"hidden"===t[i]["ui:widget"]&&(n||(n=Object(r.cloneDeep)(e)),delete n.properties[i]);return n||e}function M(e){let t=[];if(!e)return t;const n=e instanceof E?e:I(Object(r.pick)(e,["code","message","data"]));return"rest_invalid_param"===n.getErrorCode()&&(t=Object.values(n.getErrorData().params)),[...n.getAllErrorMessages(),...t]}},YLtl:function(e,t){!function(){e.exports=this.lodash}()},l3Sj:function(e,t){!function(){e.exports=this.wp.i18n}()},"oYJ/":function(e,t,n){"use strict";n.r(t),n.d(t,"controls",(function(){return D})),n.d(t,"CORE_STORE_NAME",(function(){return Un})),n.d(t,"BANS_STORE_NAME",(function(){return Ie})),n.d(t,"HELP_STORE_NAME",(function(){return Me})),n.d(t,"MODULES_STORE_NAME",(function(){return Zt})),n.d(t,"apiFetch",(function(){return b})),n.d(t,"apiFetchResult",(function(){return v})),n.d(t,"select",(function(){return _})),n.d(t,"dispatch",(function(){return I})),n.d(t,"fetch",(function(){return T})),n.d(t,"parseFetchResponse",(function(){return O})),n.d(t,"awaitPromise",(function(){return A})),n.d(t,"updateSettings",(function(){return j})),n.d(t,"createNotice",(function(){return R})),n.d(t,"apiFetchBatch",(function(){return N}));var r={};n.r(r),n.d(r,"path",(function(){return w})),n.d(r,"query",(function(){return P})),n.d(r,"fetchQueryNextPage",(function(){return x})),n.d(r,"receiveQuery",(function(){return F})),n.d(r,"receiveBan",(function(){return U})),n.d(r,"startCreateBan",(function(){return L})),n.d(r,"failedCreateBan",(function(){return k})),n.d(r,"finishCreateBan",(function(){return q})),n.d(r,"startUpdateBan",(function(){return B})),n.d(r,"failedUpdateBan",(function(){return H})),n.d(r,"finishUpdateBan",(function(){return G})),n.d(r,"startDeleteBan",(function(){return V})),n.d(r,"failedDeleteBan",(function(){return Q})),n.d(r,"finishDeleteBan",(function(){return Y})),n.d(r,"createBan",(function(){return W})),n.d(r,"updateBan",(function(){return X})),n.d(r,"deleteBan",(function(){return K})),n.d(r,"RECEIVE_QUERY",(function(){return J})),n.d(r,"START_QUERY",(function(){return $})),n.d(r,"FINISH_QUERY",(function(){return Z})),n.d(r,"FAILED_QUERY",(function(){return z})),n.d(r,"START_CREATE_BAN",(function(){return ee})),n.d(r,"FINISH_CREATE_BAN",(function(){return te})),n.d(r,"FAILED_CREATE_BAN",(function(){return ne})),n.d(r,"RECEIVE_BAN",(function(){return re})),n.d(r,"START_UPDATE_BAN",(function(){return ie})),n.d(r,"FINISH_UPDATE_BAN",(function(){return se})),n.d(r,"FAILED_UPDATE_BAN",(function(){return ue})),n.d(r,"START_DELETE_BAN",(function(){return oe})),n.d(r,"FINISH_DELETE_BAN",(function(){return ce})),n.d(r,"FAILED_DELETE_BAN",(function(){return de}));var i={};n.r(i),n.d(i,"getBans",(function(){return ae})),n.d(i,"getQueryResults",(function(){return fe})),n.d(i,"getQueryHeaderLink",(function(){return ge})),n.d(i,"getQueryHeaderLinks",(function(){return ye})),n.d(i,"getQueryHeader",(function(){return Ee})),n.d(i,"getBan",(function(){return he})),n.d(i,"isUpdating",(function(){return pe})),n.d(i,"isDeleting",(function(){return me})),n.d(i,"isQuerying",(function(){return Se}));var s={};n.r(s),n.d(s,"getBans",(function(){return be}));var u={};n.r(u),n.d(u,"fetchHelp",(function(){return Te})),n.d(u,"enableHelp",(function(){return Oe})),n.d(u,"RECEIVE_HELP",(function(){return Ae}));var o={};n.r(o),n.d(o,"getHelp",(function(){return Re})),n.d(o,"isEnabled",(function(){return Ne}));var c={};n.r(c),n.d(c,"getHelp",(function(){return Ce}));var d={};n.r(d),n.d(d,"editModule",(function(){return Be})),n.d(d,"saveModules",(function(){return He})),n.d(d,"resetModuleEdits",(function(){return Ge})),n.d(d,"activateModule",(function(){return Ve})),n.d(d,"deactivateModule",(function(){return Qe})),n.d(d,"setModulesStatus",(function(){return Ye})),n.d(d,"editSettings",(function(){return We})),n.d(d,"editSetting",(function(){return Xe})),n.d(d,"resetSettingEdits",(function(){return Ke})),n.d(d,"saveSettings",(function(){return Je})),n.d(d,"updateSettings",(function(){return $e})),n.d(d,"fetchModules",(function(){return ze})),n.d(d,"receiveModules",(function(){return et})),n.d(d,"receiveModule",(function(){return tt})),n.d(d,"receiveSettings",(function(){return nt})),n.d(d,"RECEIVE_MODULES",(function(){return rt})),n.d(d,"RECEIVE_MODULE",(function(){return it})),n.d(d,"EDIT_MODULE",(function(){return st})),n.d(d,"RESET_MODULE_EDITS",(function(){return ut})),n.d(d,"START_SAVING_MODULES",(function(){return ot})),n.d(d,"FAILED_SAVING_MODULES",(function(){return ct})),n.d(d,"FINISH_SAVING_MODULES",(function(){return dt})),n.d(d,"RECEIVE_SETTINGS",(function(){return lt})),n.d(d,"EDIT_SETTINGS",(function(){return at})),n.d(d,"EDIT_SETTING",(function(){return ft})),n.d(d,"RESET_SETTING_EDIT",(function(){return gt})),n.d(d,"RESET_SETTING_EDITS",(function(){return yt})),n.d(d,"START_SAVING_SETTINGS",(function(){return Et})),n.d(d,"FAILED_SAVING_SETTINGS",(function(){return ht})),n.d(d,"FINISH_SAVING_SETTINGS",(function(){return pt}));var l={};n.r(l),n.d(l,"getModules",(function(){return mt})),n.d(l,"getEditedModules",(function(){return St})),n.d(l,"getEditedModule",(function(){return bt})),n.d(l,"getActiveModules",(function(){return vt})),n.d(l,"getModule",(function(){return _t})),n.d(l,"isActive",(function(){return It})),n.d(l,"getModuleEdits",(function(){return Tt})),n.d(l,"isSavingModule",(function(){return Ot})),n.d(l,"getDirtyModules",(function(){return At})),n.d(l,"isModuleDirty",(function(){return jt})),n.d(l,"getSettings",(function(){return Rt})),n.d(l,"getSetting",(function(){return Nt})),n.d(l,"getSettingEdits",(function(){return Ct})),n.d(l,"getEditedSettings",(function(){return Dt})),n.d(l,"getEditedSetting",(function(){return Mt})),n.d(l,"isSavingSettings",(function(){return wt})),n.d(l,"getDirtySettings",(function(){return Pt})),n.d(l,"areSettingsDirty",(function(){return xt})),n.d(l,"getError",(function(){return Ft})),n.d(l,"__unstableGetAllSettings",(function(){return Ut})),n.d(l,"__unstableGetAllEditedSettings",(function(){return Lt})),n.d(l,"getSettingSchema",(function(){return kt}));var a={};n.r(a),n.d(a,"getModules",(function(){return Bt})),n.d(a,"getSettings",(function(){return Ht})),n.d(a,"__unstableGetAllSettings",(function(){return Gt})),n.d(a,"__unstableGetAllEditedSettings",(function(){return Vt})),n.d(a,"getEditedModules",(function(){return Qt})),n.d(a,"getModule",(function(){return Yt})),n.d(a,"getEditedModule",(function(){return Wt})),n.d(a,"getActiveModules",(function(){return Xt})),n.d(a,"getSetting",(function(){return Kt})),n.d(a,"getEditedSettings",(function(){return Jt})),n.d(a,"getEditedSetting",(function(){return $t}));var f={};n.r(f),n.d(f,"getUser",(function(){return zt})),n.d(f,"getCurrentUser",(function(){return en})),n.d(f,"getIndex",(function(){return tn})),n.d(f,"getSchema",(function(){return nn})),n.d(f,"getRoles",(function(){return rn})),n.d(f,"getActorTypes",(function(){return sn})),n.d(f,"getActors",(function(){return un})),n.d(f,"getSiteInfo",(function(){return on})),n.d(f,"getFeatureFlags",(function(){return cn})),n.d(f,"getBatchMaxItems",(function(){return dn}));var g={};n.r(g),n.d(g,"fetchIndex",(function(){return ln})),n.d(g,"receiveIndex",(function(){return an})),n.d(g,"receiveUser",(function(){return fn})),n.d(g,"receiveCurrentUserId",(function(){return gn})),n.d(g,"receiveActorTypes",(function(){return yn})),n.d(g,"receiveActors",(function(){return En})),n.d(g,"receiveSiteInfo",(function(){return hn})),n.d(g,"__unstableLoadInitialFeatureFlags",(function(){return pn})),n.d(g,"receiveBatchMaxItems",(function(){return mn})),n.d(g,"RECEIVE_INDEX",(function(){return Sn})),n.d(g,"RECEIVE_USER",(function(){return bn})),n.d(g,"RECEIVE_CURRENT_USER_ID",(function(){return vn})),n.d(g,"RECEIVE_ACTOR_TYPES",(function(){return _n})),n.d(g,"RECEIVE_ACTORS",(function(){return In})),n.d(g,"RECEIVE_SITE_INFO",(function(){return Tn})),n.d(g,"LOAD_INITIAL_FEATURE_FLAGS",(function(){return On})),n.d(g,"RECEIVE_BATCH_MAX_ITEMS",(function(){return An}));var y={};n.r(y),n.d(y,"getIndex",(function(){return jn})),n.d(y,"getSchema",(function(){return Rn})),n.d(y,"getRoles",(function(){return Nn})),n.d(y,"getUser",(function(){return Cn})),n.d(y,"getCurrentUser",(function(){return Dn})),n.d(y,"getActorTypes",(function(){return Mn})),n.d(y,"getActors",(function(){return wn})),n.d(y,"getSiteInfo",(function(){return Pn})),n.d(y,"getBatchMaxItems",(function(){return xn}));var E=n("1ZqX"),h=n("YLtl"),p=n("ywyh"),m=n.n(p),S=n("Td6G");function b(e){return{type:"API_FETCH",request:e}}function v(e){return{type:"API_FETCH_RESULT",request:e}}function _(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return{type:"SELECT",storeKey:e,selectorName:t,args:r}}function I(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return{type:"DISPATCH",storeKey:e,actionName:t,args:r}}function T(e,t){return{type:"FETCH",request:e,init:t}}function O(e){return{type:"PARSE_FETCH_RESPONSE",response:e}}function A(e,t){return{type:"AWAIT_PROMISE",promise:e,delay:t}}function j(e,t){return{type:"UPDATE_SETTINGS",module:e,settings:t}}function R(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"info",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return{type:"CREATE_NOTICE",status:e,content:t,options:{context:"ithemes-security",...n}}}function N(e){return{type:"API_FETCH_BATCH",batch:e}}const C={AWAIT_PROMISE:e=>{let{promise:t,delay:n}=e;return n?Promise.all([t,(r=n,new Promise(e=>setTimeout(e,r)))]):t;var r},API_FETCH(e){let{request:t}=e;return m()(t).catch(S.l)},API_FETCH_RESULT(e){let{request:t}=e;return m()({...t,parse:!1}).then(S.b.fromResponse).catch(S.l).catch(e=>e.getResponse?S.b.fromResponse(e.getResponse()):new S.b(S.b.ERROR,new S.c("unknown_error","Unknown error")))},SELECT(e){let{storeKey:t,selectorName:n,args:r}=e;const i=Object(E.select)(t)[n];return i.hasResolver?(e=>{let{storeKey:t,selectorName:n,args:r}=e;return new Promise(e=>{const i=()=>Object(E.select)("core/data").hasFinishedResolution(t,n,r),s=()=>Object(E.select)(t)[n].apply(null,r),u=s();if(i())return e(u);const o=Object(E.subscribe)(()=>{i()&&(o(),e(s()))})})})({storeKey:t,selectorName:n,args:r}):i(...r)},DISPATCH(e){let{storeKey:t,actionName:n,args:r}=e;return Object(E.dispatch)(t)[n](...r)},PARSE_FETCH_RESPONSE:async function(e){let{response:t}=e;return await t.json()},FETCH(e){let{request:t,init:n}=e;return window.fetch(t,n)},UPDATE_SETTINGS:Object(E.createRegistryControl)(e=>t=>{let{module:n,settings:r}=t;return e.dispatch("ithemes-security/modules").updateSettings(n,r)}),CREATE_NOTICE(e){let{status:t,content:n,options:r}=e;r.autoDismiss&&(r.id=r.id||Object(h.uniqueId)("itsec-auto-dismiss-"),setTimeout(()=>Object(E.dispatch)("core/notices").removeNotice(r.id,r.context),r.autoDismiss)),Object(E.dispatch)("core/notices").createNotice(t,n,r)},API_FETCH_BATCH:Object(E.createRegistryControl)(e=>async t=>{let{batch:n}=t;const r=await e.resolveSelect(Un).getBatchMaxItems(),i=Object(h.chunk)(n,r||25),s=[],u=[];if(!i.length)return[];for(const e of i)try{const t=await C.API_FETCH({request:{path:"/batch/v1",method:"POST",data:{requests:e}}});u.push(...t.responses)}catch(t){s.push(t),u.push(...Object(h.times)(e.length,Object(h.constant)({body:t,status:500,headers:{}})))}if(s.length===i.length)throw s[0];return u})};var D=C,M=n("Mmq9");const w="/ithemes-security/v1/bans";function*P(e){let t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};yield{type:$,queryId:e,queryParams:r};try{t=yield b({path:Object(M.addQueryArgs)(w,r),parse:!1}),n=yield O(t)}catch(t){return yield{type:z,queryId:e,queryParams:r,error:t},t}return yield F(e,r.context||"view",t,n,"replace"),yield{type:Z,queryId:e,queryParams:r,response:t},t}function*x(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"append";const n=yield _("ithemes-security/bans","getQueryHeaderLink",e,"next");if(!n)return[];let r,i;yield{type:$,queryId:e};try{r=yield b({url:n.link,parse:!1}),i=yield O(r)}catch(t){return yield{type:z,queryId:e,error:t},t}const s=Object(M.getQueryArg)(n.link,"context")||"view";return yield F(e,s,r,i,t),yield{type:Z,queryId:e,response:r},r}function F(e,t,n,r,i){return{type:J,queryId:e,context:t,response:n,items:r,mode:i}}function U(e){return{type:re,ban:e}}function L(e){return{type:ee,ban:e}}function k(e,t){return{type:ne,ban:e,error:t}}function q(e,t){return{type:te,ban:e,response:t}}function B(e,t){return{type:ie,self:e,ban:t}}function H(e,t){return{type:ue,self:e,error:t}}function G(e,t){return{type:se,self:e,response:t}}function V(e){return{type:oe,self:e}}function Q(e,t){return{type:de,self:e,error:t}}function Y(e){return{type:ce,self:e}}function*W(e,t){const n={method:"POST",data:t};let r;Object(M.isURL)(e)?n.url=e:n.path=`${w}/${e}`,yield L(t);try{r=yield b(n)}catch(e){return yield k(t,e),e}return yield q(t,r),yield U(r),r}function*X(e,t){const n=Object(h.isObject)(e)?Object(S.h)(e):e;let r;yield B(n,t);try{r=yield b({url:n,method:"PUT",data:t})}catch(e){return yield H(n,e),e}return yield G(n,r),yield U(r),r}function*K(e){const t=Object(h.isObject)(e)?Object(S.h)(e):e;yield V(t);try{yield b({url:t,method:"DELETE"})}catch(e){return yield Q(t,e),e}return yield Y(t),null}const J="RECEIVE_QUERY",$="START_QUERY",Z="FINISH_QUERY",z="FAILED_QUERY",ee="START_CREATE_BAN",te="FINISH_CREATE_BAN",ne="FAILED_CREATE_BAN",re="RECEIVE_BAN",ie="START_UPDATE_BAN",se="FINISH_UPDATE_BAN",ue="FAILED_UPDATE_BAN",oe="START_DELETE_BAN",ce="FINISH_DELETE_BAN",de="FAILED_DELETE_BAN";var le=n("pPDe");const ae=Object(E.createRegistrySelector)(e=>()=>e("ithemes-security/bans").getQueryResults("main")),fe=Object(le.a)((e,t)=>{const n=Object(h.get)(e,["queries",t,"selves"],[]),r=e.bySelf,i=n.length,s=new Array(i);let u=-1;for(;++u<i;){const e=r[n[u]];e&&(s[u]=e.item)}return s},(e,t)=>[e.queries[t],e.bySelf]);function ge(e,t,n){return Object(h.find)(Object(h.get)(e,["queries",t,"links"],[]),{rel:n})}function ye(e,t,n){return Object(h.filter)(Object(h.get)(e,["queries",t,"links"],[]),{rel:n})}function Ee(e,t,n){return Object(h.get)(e,["queries",t,"headers",n])}function he(e,t){return e.bySelf[t]}function pe(e,t){const n=Object(h.isObject)(t)?Object(S.h)(t):t;return e.updating.includes(n)}function me(e,t){const n=Object(h.isObject)(t)?Object(S.h)(t):t;return e.deleting.includes(n)}function Se(e,t){return e.querying.includes(t)}function*be(){yield I("ithemes-security/bans","query","main",{per_page:100})}var ve=n("/fTC");const _e={bySelf:{},queries:{},querying:[],creating:[],updating:[],deleting:[]};const Ie="ithemes-security/bans";function*Te(e){const t="https://ithemes.com/wp-json/ithemes/v1/inline-help/itsec/"+encodeURIComponent(e),n=yield T(t,{credentials:"omit",referrer:"no-referrer"});if(!n.ok)return;if(n.status>=400)return;const r=yield O(n);yield{type:Ae,topic:e,help:r}}function*Oe(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];yield j("global",{enable_remote_help:e})}Object(E.registerStore)(Ie,{controls:D,actions:r,selectors:i,resolvers:s,reducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_e,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case J:return{...e,queries:{...e.queries,[t.queryId]:{selves:"replace"===t.mode?Object(h.map)(t.items,S.h):[...Object(h.get)(e,["queries",t.queryId,"selves"],[]),...Object(h.map)(t.items,S.h)],headers:Object(h.fromPairs)(Array.from(t.response.headers.entries())),links:Object(ve.parse)(t.response.headers.get("link"),{extended:!0}).map(e=>({...e,rel:e.rel[0]}))}},bySelf:{...e.bySelf,...Object(h.fromPairs)(t.items.filter(n=>{const r=Object(S.h)(n);return!e.bySelf[r]||("embed"===e.bySelf[r].context||e.bySelf[r].context===t.context)}).map(e=>[Object(S.h)(e),{context:t.context,item:e}]))}};case $:return{...e,querying:[...e.querying,t.queryId]};case Z:case z:return{...e,querying:e.querying.filter(e=>e!==t.queryId)};case re:return{...e,bySelf:{...e.bySelf,[Object(S.h)(t.ban)]:{context:"edit",item:t.ban}}};case ee:return{...e,creating:[...e.creating,t.ban]};case te:case ne:return{...e,creating:e.creating.filter(e=>e!==t.ban)};case ie:return{...e,updating:[...e.updating,t.self]};case se:case ue:return{...e,updating:e.updating.filter(e=>e!==t.self)};case oe:return{...e,deleting:[...e.deleting,t.self],bySelf:Object(h.omit)(e.bySelf,[t.self])};case ce:case de:return{...e,deleting:e.deleting.filter(e=>e!==t.self)};default:return e}}});const Ae="RECEIVE_HELP",je=[];function Re(e,t){return e.byTopic[t]||je}const Ne=Object(E.createRegistrySelector)(e=>()=>{var t;return null===(t=e("ithemes-security/modules").getSettings("global"))||void 0===t?void 0:t.enable_remote_help});function*Ce(e){yield Te(e)}const De={byTopic:{}};const Me="ithemes-security/help";Object(E.registerStore)(Me,{controls:D,actions:u,selectors:o,resolvers:c,reducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:De,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ae:return{...e,byTopic:{...e.byTopic,[t.topic]:t.help}};default:return e}}});const we=e=>e instanceof Date,Pe=e=>0===Object.keys(e).length,xe=e=>null!=e&&"object"==typeof e,Fe=(e,...t)=>Object.prototype.hasOwnProperty.call(e,...t),Ue=e=>xe(e)&&Pe(e);const Le=(e,t)=>{if(e===t)return{};if(!xe(e)||!xe(t))return t;const n=e,r=t;return we(n)||we(r)?n.valueOf()==r.valueOf()?{}:r:Object.keys(r).reduce((e,t)=>{if(Fe(n,t)){const i=Le(n[t],r[t]);return!Ue(i)||we(i)||!Ue(n[t])&&Ue(r[t])?(e[t]=i,e):e}return e},{})};var ke=Le;var qe=n("l3Sj");function*Be(e,t){const n=yield E.controls.select(Zt,"getModule",e);n?yield{type:st,module:e,edit:ke(n,t)}:yield{type:st,module:e,edit:t}}function*He(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===e?e=yield E.controls.select(Zt,"getDirtyModules"):Object(h.isString)(e)&&(e=[e]),!e.length)return[];const t=[];for(const n of e){const e=yield E.controls.select(Zt,"getModuleEdits",n);t.push({method:"PUT",path:"/ithemes-security/v1/modules/"+n,body:e})}let n;try{yield{type:ot,modules:e},n=yield N(t)}catch(t){return yield{type:ct,modules:e},yield R("error",t.message),t}const r=[],i={};for(let s=0;s<t.length;s++){const t=e[s],u=n[s];u.status>=400?i[t]=u.body:(r.push(t),yield tt(t,u.body))}return Object(h.isEmpty)(i)||(yield{type:ct,errors:i}),r.length&&(yield{type:dt,modules:r}),n}function*Ge(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];!0===e?e=yield E.controls.select(Zt,"getDirtyModules"):Object(h.isString)(e)&&(e=[e]),yield{type:ut,modules:e}}function*Ve(e){try{const t=yield Ze(e,"active");yield tt(t),yield{type:dt,modules:[e]},t.side_effects&&(yield ze())}catch(t){yield{type:ct,errors:{[e]:t}}}}function*Qe(e){try{const t=yield Ze(e,"inactive");yield tt(t),yield{type:dt,modules:[e]},t.side_effects&&(yield ze())}catch(t){yield{type:ct,errors:{[e]:t}}}}function*Ye(e){const t={requests:Object(h.map)(e,(e,t)=>({path:"/ithemes-security/v1/modules/"+t,method:"PUT",body:{status:{selected:e}}}))},n=yield N(t);for(let e=0;e<n.length;e++){const t=n[e];t.status>=400?yield R("error",t.body.message):yield tt(t.body)}}function*We(e,t){const n=yield E.controls.select(Zt,"getSettings",e);if(!n)return void(yield{type:at,module:e,edit:t});const r={};let i=!1;for(const e in t)t.hasOwnProperty(e)&&(Object(h.isEqual)(t[e],n[e])||(r[e]=t[e],i=!0));i?yield{type:at,module:e,edit:r}:yield Ke(e)}function*Xe(e,t,n){const r=yield E.controls.select(Zt,"getSetting",e,t);Object(h.isEqual)(r,n)?yield{type:gt,module:e,setting:t}:yield{type:ft,module:e,setting:t,value:n}}function*Ke(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];!0===e?e=yield E.controls.select(Zt,"getDirtySettings"):Object(h.isString)(e)&&(e=[e]),yield{type:yt,modules:e}}function*Je(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===e?e=yield E.controls.select(Zt,"getDirtySettings"):Object(h.isString)(e)&&(e=[e]),!e.length)return[];const t=[];for(const n of e){const e=yield E.controls.select(Zt,"getSettingEdits",n);t.push({method:"PATCH",path:"/ithemes-security/v1/settings/"+n,body:e})}let n;try{yield{type:Et,modules:e},n=yield N(t)}catch(t){return yield{type:ht,modules:e},yield R("error",t.message),t}const r=[],i={};for(let s=0;s<t.length;s++){const t=e[s],u=n[s];u.status>=400?i[t]=u.body:(r.push(t),yield nt(t,u.body))}return Object(h.isEmpty)(i)||(yield{type:ht,errors:i}),r.length&&(yield R("success",Object(qe.__)("Saved settings.","better-wp-security"),{type:"snackbar"}),yield{type:pt,modules:r}),n}function*$e(e,t){let n;yield{type:Et,modules:[e]};try{n=yield b({path:"/ithemes-security/v1/settings/"+e,method:"PATCH",data:t}),yield nt(e,n)}catch(t){return yield{type:ht,errors:{[e]:t}},t}return yield{type:pt,modules:[e]},n}function Ze(e,t){return b({method:"PUT",path:"/ithemes-security/v1/modules/"+e,data:{status:{selected:t}}})}function*ze(){const e=yield b({path:"/ithemes-security/v1/modules?context=edit&_embed=1"});yield et(e)}function et(e){return{type:rt,modules:e}}function tt(e){return{type:it,module:e}}function nt(e,t){return{type:lt,module:e,settings:t}}const rt="RECEIVE_MODULES",it="RECEIVE_MODULE",st="EDIT_MODULE",ut="RESET_MODULE_EDITS",ot="START_SAVING_MODULES",ct="FAILED_SAVING_MODULES",dt="FINISH_SAVING_MODULES",lt="RECEIVE_SETTINGS",at="EDIT_SETTINGS",ft="EDIT_SETTING",gt="RESET_SETTING_EDIT",yt="RESET_SETTING_EDITS",Et="START_SAVING_SETTINGS",ht="FAILED_SAVING_SETTINGS",pt="FINISH_SAVING_SETTINGS";function mt(e){return e.modules}const St=Object(le.a)(e=>e.modules.map(t=>({...t,...e.moduleEdits[t.id]||{}})),e=>[e.modules,e.moduleEdits]),bt=Object(le.a)((e,t)=>({...e.modules[t]||{},...e.moduleEdits[t]||{}}),(e,t)=>[e.modules[t],e.moduleEdits[t]]),vt=Object(le.a)(e=>e.modules.filter(e=>"active"===e.status.selected).map(e=>e.id),e=>e.modules);function _t(e,t){return e.modules.find(e=>e.id===t)}function It(e,t){var n;return"active"===(null===(n=_t(e,t))||void 0===n?void 0:n.status.selected)}function Tt(e,t){return e.moduleEdits[t]}function Ot(e,t){return e.savingModules.includes(t)}function At(e){return Object.keys(e.moduleEdits)}function jt(e,t){return!!e.moduleEdits[t]}function Rt(e,t){var n;return null!==(n=e.settings[t])&&void 0!==n?n:{}}function Nt(e,t,n){var r;return null===(r=e.settings[t])||void 0===r?void 0:r[n]}function Ct(e,t){return e.settingEdits[t]}const Dt=Object(le.a)((e,t)=>({...e.settings[t]||{},...e.settingEdits[t]||{}}),(e,t)=>[e.settings[t],e.settingEdits[t]]);function Mt(e,t,n){var r,i;return(null===(r=e.settingEdits[t])||void 0===r?void 0:r[n])||(null===(i=e.settings[t])||void 0===i?void 0:i[n])}function wt(e,t){return e.savingSettings.includes(t)}function Pt(e){return Object.keys(e.settingEdits)}function xt(e,t){return e.settingEdits[t]&&!Object(h.isEmpty)(e.settingEdits[t])}function Ft(e,t){return e.errors[t]}function Ut(e){return e.settings}const Lt=Object(le.a)(e=>Object(h.reduce)(e.settings,(t,n,r)=>(t[r]={...n,...e.settingEdits[r]||{}},t),{}),e=>[e.settings,e.settingEdits]);function kt(e,t,n){var r,i;return null===(r=_t(e,t))||void 0===r||null===(i=r.settings)||void 0===i?void 0:i.schema.properties[n]}const qt={modules:[],moduleEdits:{},savingModules:[],settings:{},settingEdits:{},savingSettings:[],errors:{}};const Bt={*fulfill(){yield ze()},isFulfilled:e=>e.modules.length>0},Ht={*fulfill(e){const t=yield b({path:"/ithemes-security/v1/settings/"+e});yield nt(e,t)},isFulfilled:(e,t)=>e.settings.hasOwnProperty(t)},Gt={*fulfill(){yield E.controls.resolveSelect(Zt,"getModules")},isFulfilled:e=>!Object(h.isEmpty)(e.settings)};function*Vt(){yield E.controls.resolveSelect(Zt,"__unstableGetAllSettings")}function*Qt(){yield E.controls.resolveSelect(Zt,"getModules")}const Yt={*fulfill(){yield E.controls.resolveSelect(Zt,"getModules")},isFulfilled:(e,t)=>e.modules.includes(e=>e.id===t)};function*Wt(){yield E.controls.resolveSelect(Zt,"getModules")}function*Xt(){yield E.controls.resolveSelect(Zt,"getModules")}function*Kt(e){yield E.controls.resolveSelect(Zt,"getSettings",e)}function*Jt(e){yield E.controls.resolveSelect(Zt,"getSettings",e)}function*$t(e){yield E.controls.resolveSelect(Zt,"getSettings",e)}const Zt="ithemes-security/modules";Object(E.registerStore)(Zt,{controls:D,actions:d,selectors:l,resolvers:a,reducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case rt:return{...e,modules:[...t.modules],settings:{...e.settings,...t.modules.reduce((e,t)=>{const n=Object(h.get)(t,["_embedded","ithemes-security:settings",0]);return n?{...e,[t.id]:n}:e},{})}};case it:return{...e,modules:e.modules.map(e=>e.id===t.module.id?t.module:e),settings:{...e.settings,[t.module.id]:Object(h.get)(t.module,["_embedded","ithemes-security:settings",0],e.settings[t.module.id])}};case st:return{...e,moduleEdits:{...e.moduleEdits,[t.module]:t.edit}};case ut:return{...e,moduleEdits:Object(h.omit)(e.moduleEdits,t.modules)};case ot:return{...e,savingModules:[...e.savingModules,...t.modules]};case dt:return{...e,savingModules:e.savingModules.filter(e=>!t.modules.includes(e)),moduleEdits:Object(h.omit)(e.moduleEdits,t.modules),errors:Object(h.omit)(e.errors,t.modules)};case ct:return{...e,savingModules:Object(h.without)(e.savingModules,...Object.keys(t.errors||{}),...t.modules||[]),errors:{...e.errors,...t.errors}};case lt:return{...e,settings:{...e.settings,[t.module]:t.settings}};case at:return{...e,settingEdits:{...e.settingEdits,[t.module]:t.edit}};case ft:return{...e,settingEdits:{...e.settingEdits,[t.module]:{...e.settingEdits[t.module]||{},[t.setting]:t.value}}};case gt:return{...e,settingEdits:{...e.settingEdits,[t.module]:Object(h.omit)(e.settingEdits[t.module]||{},t.setting)}};case yt:return{...e,settingEdits:Object(h.omit)(e.settingEdits,t.modules)};case Et:return{...e,savingSettings:[...e.savingSettings,...t.modules]};case pt:return{...e,savingSettings:e.savingSettings.filter(e=>!t.modules.includes(e)),settingEdits:Object(h.omit)(e.settingEdits,t.modules),errors:Object(h.omit)(e.errors,t.modules)};case ht:return{...e,savingSettings:Object(h.without)(e.savingSettings,...Object.keys(t.errors||{}),...t.modules||[]),errors:{...e.errors,...t.errors}};default:return e}},persist:["moduleEdits","settingEdits"]});function zt(e,t){return e.users.byId[t]}function en(e){return e.users.byId[e.users.currentId]}function tn(e){return e.index}function nn(e,t){const n=e.index;if(!n)return null;for(const e in n.routes){if(!n.routes.hasOwnProperty(e))continue;const r=n.routes[e].schema;if(r&&r.title===t)return r}return null}function rn(e){var t;return(null===(t=e.index)||void 0===t?void 0:t.roles)||null}function sn(e){return e.actors.types}function un(e,t){return e.actors.byType[t]}function on(e){return e.siteInfo}const cn=Object(E.createRegistrySelector)(e=>t=>e(Zt).getSetting("feature-flags","enabled")||t.featureFlags);function dn(e){return e.batchMaxItems}function*ln(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t="/ithemes-security/v1?context=help";e&&(t+="&_="+Date.now());const n=yield b({path:t});return yield an(n),n}function an(e){return{type:Sn,index:e}}function fn(e){return{type:bn,user:e}}function gn(e){return{type:vn,userId:e}}function yn(e){return{type:_n,types:e}}function En(e,t){return{type:In,actorType:e,actors:t}}function hn(e){return{type:Tn,siteInfo:e}}function pn(e){return{type:On,flags:e}}function mn(e){return{type:An,maxItems:e}}const Sn="RECEIVE_INDEX",bn="RECEIVE_USER",vn="RECEIVE_CURRENT_USER_ID",_n="RECEIVE_ACTOR_TYPES",In="RECEIVE_ACTORS",Tn="RECEIVE_SITE_INFO",On="LOAD_INITIAL_FEATURE_FLAGS",An="RECEIVE_BATCH_MAX_ITEMS";function*jn(){const e=yield b({path:"/ithemes-security/v1?context=help"});yield an(e)}const Rn={*fulfill(){yield E.controls.resolveSelect("ithemes-security/core","getIndex")},isFulfilled:e=>!!e.index},Nn={*fulfill(){yield E.controls.resolveSelect("ithemes-security/core","getIndex")},isFulfilled:e=>!!e.index},Cn={*fulfill(e){const t=yield b({path:"/wp/v2/users/"+e});yield fn(t)},isFulfilled:(e,t)=>!!e.users.byId[t]},Dn={*fulfill(){const e=yield b({path:"/wp/v2/users/me?context=edit"});yield fn(e),yield gn(e.id)},isFulfilled:e=>e.users.currentId&&e.users.byId[e.users.currentId]},Mn={*fulfill(){const e=yield b({path:"/ithemes-security/v1/actors?_embed=1"}),t=[];for(const n of e){const e=Object(h.get)(n,["_embedded","wp:items",0],[]);yield En(n.slug,e),t.push({slug:n.slug,label:n.label})}yield yn(t)},isFulfilled:e=>e.actors.types.length>0},wn={*fulfill(){yield _("ithemes-security/core","getActorTypes")},isFulfilled:(e,t)=>!!e.actors.byType[t]},Pn={*fulfill(){const e=yield b({path:"/?_fields=name,description,url,home"});yield hn(e)},isFulfilled:e=>!!e.siteInfo};function*xn(){const e=yield b({path:"/batch/v1",method:"OPTIONS"});yield mn(e.endpoints[0].args.requests.maxItems)}const Fn={users:{currentId:0,byId:{}},index:null,actors:{types:[],byType:{}},siteInfo:null,featureFlags:[],batchMaxItems:0};n.p=window.itsecWebpackPublicPath;const Un="ithemes-security/core";Object(E.registerStore)(Un,{controls:D,selectors:f,resolvers:y,actions:g,reducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fn,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Sn:return{...e,index:t.index};case bn:return{...e,users:{...e.users,byId:{...e.users.byId,[t.user.id]:t.user}}};case vn:return{...e,users:{...e.users,currentId:t.userId}};case _n:return{...e,actors:{...e.actors,types:t.types}};case In:return{...e,actors:{...e.actors,byType:{...e.actors.byType,[t.actorType]:t.actors}}};case Tn:return{...e,siteInfo:t.siteInfo};case On:return{...e,featureFlags:t.flags};case An:return{...e,batchMaxItems:t.maxItems};default:return e}}})},pPDe:function(e,t,n){"use strict";var r,i;function s(e){return[e]}function u(){var e={clear:function(){e.head=null}};return e}function o(e,t,n){var r;if(e.length!==t.length)return!1;for(r=n;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}r={},i="undefined"!=typeof WeakMap,t.a=function(e,t){var n,c;function d(){n=i?new WeakMap:u()}function l(){var n,r,i,s,u,d=arguments.length;for(s=new Array(d),i=0;i<d;i++)s[i]=arguments[i];for(u=t.apply(null,s),(n=c(u)).isUniqueByDependants||(n.lastDependants&&!o(u,n.lastDependants,0)&&n.clear(),n.lastDependants=u),r=n.head;r;){if(o(r.args,s,1))return r!==n.head&&(r.prev.next=r.next,r.next&&(r.next.prev=r.prev),r.next=n.head,r.prev=null,n.head.prev=r,n.head=r),r.val;r=r.next}return r={val:e.apply(null,s)},s[0]=null,r.args=s,n.head&&(n.head.prev=r,r.next=n.head),n.head=r,r.val}return t||(t=s),c=i?function(e){var t,i,s,o,c,d=n,l=!0;for(t=0;t<e.length;t++){if(i=e[t],!(c=i)||"object"!=typeof c){l=!1;break}d.has(i)?d=d.get(i):(s=new WeakMap,d.set(i,s),d=s)}return d.has(r)||((o=u()).isUniqueByDependants=l,d.set(r,o)),d.get(r)}:function(){return n},l.getDependants=t,l.clear=d,d(),l}},ywyh:function(e,t){!function(){e.exports=this.wp.apiFetch}()}},[["oYJ/",0,1]]]);