this.itsec=this.itsec||{},this.itsec["user-groups"]=this.itsec["user-groups"]||{},this.itsec["user-groups"].settings=(window.itsecWebpackJsonP=window.itsecWebpackJsonP||[]).push([[30],{"1ZqX":function(e,t){!function(){e.exports=this.wp.data}()},ELjz:function(e,t,r){},GRId:function(e,t){!function(){e.exports=this.wp.element}()},"GjY+":function(e,t,r){},GrEf:function(e,t,r){},K9lf:function(e,t){!function(){e.exports=this.wp.compose}()},Mmq9:function(e,t){!function(){e.exports=this.wp.url}()},QmYb:function(e,t,r){},RUGT:function(e,t,r){"use strict";r.d(t,"b",(function(){return w})),r.d(t,"a",(function(){return $}));var s={};r.r(s),r.d(s,"registerProvider",(function(){return P})),r.d(s,"REGISTER_PROVIDER",(function(){return M}));var i={};r.r(i),r.d(i,"getProviders",(function(){return F}));var n=r("pVnL"),c=r.n(n),o=r("GRId"),u=r("55Ip"),l=r("Ty5D"),a=r("LhCv"),d=r("YLtl"),p=r("tI+e"),b=r("l3Sj"),g=r("1ZqX"),O=r("K9lf"),m=r("RxS6"),h=r("gdqT"),j=r("wLpv"),E=r("ppSj"),f=r("49++"),y=r("tmk3"),_=r.n(y),S=r("92Nh"),v=r.n(S);function I(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}var G=new WeakMap,L=new WeakMap,N=new WeakMap,R=new WeakMap,k=new WeakMap;class T{constructor(e,t){I(this,G,{writable:!0,value:void 0}),I(this,L,{writable:!0,value:void 0}),I(this,N,{writable:!0,value:void 0}),I(this,R,{writable:!0,value:void 0}),I(this,k,{writable:!0,value:void 0}),v()(this,G,e),v()(this,L,t),v()(this,N,t.select($).getProviders()),this._prepare()}_prepare(){v()(this,k,_()(this,G).split(/\s+/g).map(e=>e.trim().toLowerCase()).filter(e=>!!e));const e=_()(this,G).endsWith(" ");v()(this,R,new RegExp(_()(this,k).map((t,r)=>r+1!==_()(this,k).length||e?`(?=.*\\b${Object(d.escapeRegExp)(t)}\\b)`:`(?=.*\\b${Object(d.escapeRegExp)(t)})`).join("")+".+","gi"))}_stringMatch(e){return e&&_()(this,R).test(e)}_keywordMatch(e){return!(!e||!e.length)&&e.some(e=>_()(this,k).some((t,r)=>e.includes(" ")?this._stringMatch(e):r===_()(this,k).length-1?e.startsWith(t):t===e))}getResults(){if(_()(this,G).length<3)return[{},0];let e=0;const t=[],r={stringMatch:e=>this._stringMatch(e),keywordMatch:e=>this._keywordMatch(e)};for(const s of _()(this,N)){const i={title:s.title,items:[],groups:{}};e+=s.callback({evaluate:r,results:i,registry:_()(this,L)}),!i.items.length&&Object(d.isEmpty)(i.groups)||t.push(i)}return[t,e]}}r("YSGj");var w=Object(o.forwardRef)((function(e,t){let{onPick:r=d.noop,showResults:s}=e;const[i,n]=Object(o.useState)(""),[u,l]=Object(o.useState)(!1),a=Object(o.useRef)(),p=Object(o.useRef)(),[f,y]=Object(o.useState)([]),_=Object(g.useRegistry)(),S=Object(o.useCallback)(e=>{const t=new T(e,_).getResults();y(t[0]),Object(h.speak)(Object(b.sprintf)(Object(b._n)("%d result found.","%d results found.",t[1],"better-wp-security"),t[1]))},[_]),v=Object(O.useDebounce)(S,50),I=Object(o.useCallback)(e=>{a.current&&(e.preventDefault(),a.current.focus())},[a]);return Object(O.useKeyboardShortcut)("/",I),Object(o.createElement)("div",c()({className:"itsec-search"},Object(E.c)(()=>l(!1))),Object(o.createElement)("div",null,Object(o.createElement)(j.i,{value:i,onChange:e=>{n(e),v(e)},onFocus:()=>l(!0),onKeyDown:e=>{e.keyCode===m.DOWN&&(e.preventDefault(),p.current.focus())},ref:Object(E.e)([t,a]),placeholder:Object(b.__)("Search for feature, settings, and more","better-wp-security"),omitSeparators:!0}),(u||s)&&i.length>=3&&Object(o.createElement)(D,{results:f,exitSearch:e=>{r(e),l(!1)},ref:p,onPick:r})))}));const D=Object(o.forwardRef)((function(e,t){let{results:r,exitSearch:s,onPick:i}=e;const n=Object(o.useRef)();Object(o.useImperativeHandle)(t,()=>({focus(){n.current.focus()}}));const u=Object(O.useInstanceId)(D,"itsec-search"),g=u+"__result__",h=function(){const e=Object(l.h)();return function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"push";return e[r](Object(a.c)(t))}}(),[j,E]=Object(o.useState)("");return Object(d.isEmpty)(r)?null:Object(o.createElement)(React.Fragment,null,Object(o.createElement)(p.VisuallyHidden,{id:u+"__label"},Object(b.__)("Search Results","better-wp-security")),Object(o.createElement)(f.b,{className:"itsec-search__results",id:u,active:j&&g+j,onNavigate:e=>E(e.substr(g.length)),onKeyDown:e=>{let{keyCode:t}=e;!j||t!==m.ENTER&&t!==m.SPACE||(i(j),h(j),s())},onFocus:()=>{if(!j&&!Object(d.isEmpty)(r)){var e;const[,t]=Object.entries(r)[0];if(null!==(e=t.items)&&void 0!==e&&e.length)E(t.items[0].route);else if(!Object(d.isEmpty)(t.groups)){const[,e]=Object.entries(t.groups)[0];E(e.items[0].route)}}},role:"listbox",descendantRoles:"option",ref:n,"aria-labelledby":u+"__label"},Object(d.map)(r,(e,t)=>Object(o.createElement)(C,c()({key:t},e,{active:j,idPrefix:g,exitSearch:s})))))}));function C(e){let{title:t,items:r,groups:s,...i}=e;const n=Object(O.useInstanceId)(D,"itsec-search__kind");return Object(o.createElement)("ul",{className:"itsec-search__kind",role:"group","aria-labelledby":n},Object(o.createElement)("li",{role:"presentation",id:n},t),(r||[]).map(e=>Object(o.createElement)(U,c()({key:e.route},e,i))),Object(d.map)(s,(e,t)=>Object(o.createElement)(A,c()({key:t},e,i))))}function A(e){let{title:t,items:r,...s}=e;const i=Object(O.useInstanceId)(D,"itsec-search__group");return Object(o.createElement)("ul",{className:"itsec-search__group",role:"group","aria-labelledby":i},Object(o.createElement)("li",{role:"presentation",id:i},Object(o.createElement)("span",null,t)),(r||[]).map(e=>Object(o.createElement)(U,c()({key:e.route},e,s))))}function U(e){let{title:t,description:r,route:s,active:i,idPrefix:n,exitSearch:c}=e;return Object(o.createElement)("li",{className:"itsec-search__result",role:"option","aria-selected":i===s||void 0,id:n+s,"aria-label":t},Object(o.createElement)(u.a,{to:s,tabIndex:-1,onClick:()=>c(s)},Object(o.createElement)("span",null,t),Object(o.createElement)(f.o,{content:r,noHtml:!0,tagName:"p"})))}function P(e,t,r,s){return{type:M,slug:e,title:t,priority:r,callback:s}}const M="REGISTER_PROVIDER";var x=r("pPDe");const F=Object(x.a)(e=>Object(d.sortBy)(e.providers,"priority"),e=>e.providers),B={providers:{}};const $="ithemes-security/search";Object(g.registerStore)($,{actions:s,selectors:i,reducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case M:return{...e,providers:{...e.providers,[t.slug]:Object(d.omit)(t,["type"])}};default:return e}}})},RxS6:function(e,t){!function(){e.exports=this.wp.keycodes}()},TMLI:function(e,t,r){},Tqx9:function(e,t){!function(){e.exports=this.wp.primitives}()},TvNi:function(e,t){!function(){e.exports=this.wp.plugins}()},XO7p:function(e,t,r){},Y0od:function(e,t,r){},YLtl:function(e,t){!function(){e.exports=this.lodash}()},YSGj:function(e,t,r){},ZRc3:function(e,t,r){},cDcd:function(e,t){!function(){e.exports=this.React}()},epig:function(e,t,r){"use strict";r.r(t);var s={};r.r(s),r.d(s,"editGroup",(function(){return Se})),r.d(s,"saveGroup",(function(){return ve})),r.d(s,"saveGroups",(function(){return Ie})),r.d(s,"resetEdits",(function(){return Ge})),r.d(s,"resetAllEdits",(function(){return Le})),r.d(s,"markGroupForDeletion",(function(){return Ne})),r.d(s,"deleteGroup",(function(){return Re})),r.d(s,"deleteLocalGroups",(function(){return ke})),r.d(s,"createLocalGroup",(function(){return Te})),r.d(s,"editGroupSetting",(function(){return we})),r.d(s,"saveGroupSettings",(function(){return De})),r.d(s,"saveGroupSettingsAsBatch",(function(){return Ce})),r.d(s,"bulkEditGroupSetting",(function(){return Ae})),r.d(s,"resetBulkGroupSettingEdit",(function(){return Ue})),r.d(s,"resetBulkGroupSettingEdits",(function(){return Pe})),r.d(s,"saveBulkEdits",(function(){return Me})),r.d(s,"saveGroupAndSettings",(function(){return xe})),r.d(s,"applyDefaultGroupSettings",(function(){return Fe})),r.d(s,"createDefaultGroups",(function(){return Be})),r.d(s,"SET_GROUP_ERROR",(function(){return $e})),r.d(s,"SET_BULK_ERRORS",(function(){return Ve})),r.d(s,"EDIT_GROUP",(function(){return He})),r.d(s,"RESET_EDITS",(function(){return Ke})),r.d(s,"RESET_ALL_EDITS",(function(){return We})),r.d(s,"CREATE_LOCAL_GROUP",(function(){return qe})),r.d(s,"DELETE_LOCAL_GROUP",(function(){return Ye})),r.d(s,"DELETE_LOCAL_GROUPS",(function(){return ze})),r.d(s,"MARK_GROUP_FOR_DELETION",(function(){return Xe})),r.d(s,"START_SAVE_GROUP",(function(){return Ze})),r.d(s,"FINISH_SAVE_GROUP",(function(){return Qe})),r.d(s,"FAILED_SAVE_GROUP",(function(){return Je})),r.d(s,"EDIT_GROUP_SETTING",(function(){return et})),r.d(s,"RESET_GROUP_SETTING",(function(){return tt})),r.d(s,"START_SAVE_GROUP_SETTINGS",(function(){return rt})),r.d(s,"FINISH_SAVE_GROUP_SETTINGS",(function(){return st})),r.d(s,"FAILED_SAVE_GROUP_SETTINGS",(function(){return it})),r.d(s,"BULK_EDIT_GROUP_SETTING",(function(){return nt})),r.d(s,"RESET_BULK_GROUP_SETTING_EDIT",(function(){return ct})),r.d(s,"RESET_BULK_GROUP_SETTING_EDITS",(function(){return ot}));var i={};r.r(i),r.d(i,"getLocalGroupIds",(function(){return lt})),r.d(i,"isLocalGroup",(function(){return at})),r.d(i,"getMatchableType",(function(){return dt})),r.d(i,"isSavingGroupOrSettings",(function(){return pt})),r.d(i,"getEditedGroup",(function(){return bt})),r.d(i,"getEditedGroupAttribute",(function(){return gt})),r.d(i,"getEditedMatchableLabel",(function(){return Ot})),r.d(i,"hasEdits",(function(){return mt})),r.d(i,"getDirtyGroups",(function(){return ht})),r.d(i,"settingHasEdits",(function(){return jt})),r.d(i,"getGroupSettingsEdits",(function(){return Et})),r.d(i,"getEditedGroupSettings",(function(){return yt})),r.d(i,"getEditedGroupSetting",(function(){return _t})),r.d(i,"getEditedGroupsBySetting",(function(){return St})),r.d(i,"getDirtyGroupSettings",(function(){return vt})),r.d(i,"isDirty",(function(){return It})),r.d(i,"hasBulkSettingEdits",(function(){return Gt})),r.d(i,"getBulkSettingEdits",(function(){return Lt})),r.d(i,"getBulkSettingEdit",(function(){return Nt})),r.d(i,"getBulkSettingValue",(function(){return Rt})),r.d(i,"isSavingBulkEdits",(function(){return kt})),r.d(i,"getAvailableGroups",(function(){return Tt})),r.d(i,"getMatchableNavIds",(function(){return Dt})),r.d(i,"getGroupsMarkedForDeletion",(function(){return Ct})),r.d(i,"getError",(function(){return At})),r.d(i,"getBulkErrorsList",(function(){return Ut}));var n={};r.r(n),r.d(n,"getAvailableGroups",(function(){return Pt}));var c=r("GRId"),o=r("l3Sj"),u=r("TvNi"),l=(r("onLe"),r("z1rk")),a=(r("sPxh"),r("on51"));function d(){return Object(c.createElement)(E,null)}var p=r("Ty5D"),b=r("55Ip"),g=r("TZi5"),O=r("1ZqX"),m=r("tI+e"),h=r("49++"),j=r("ppSj");r("GjY+");function E(){const{url:e,path:t,isExact:r}=Object(p.k)(),{hash:s,search:i}=Object(p.i)(),{root:n}=Object(p.j)(),u=Object(a.useNavigateTo)(),l=Object(O.useSelect)(e=>e("ithemes-security/user-groups-editor").getMatchableNavIds()),{createLocalGroup:d}=Object(O.useDispatch)("ithemes-security/user-groups-editor");if(null===l)return null;return Object(c.createElement)(React.Fragment,null,!r&&Object(c.createElement)(y,{navIds:l,url:e,search:i,hash:s}),Object(c.createElement)(p.d,null,Object(c.createElement)(p.b,{path:t+"/multi"},Object(c.createElement)(S,{navIds:l})),Object(c.createElement)(p.b,{path:t+"/:child"},Object(c.createElement)(a.NavigationFill,null,Object(c.createElement)(m.Button,{isLink:!0,onClick:async()=>{const{id:t}=await d();u(`${e}/${t}/edit`)},className:"itsec-add-new-user-group-link"},Object(o.__)("New Group","better-wp-security"))),Object(c.createElement)(_,{root:n})),Object(c.createElement)(p.b,{path:t},l.length>0&&("onboard"===n?Object(c.createElement)(f,null):Object(c.createElement)(p.a,{to:`${e}/${l[0]}/${i}${s}`})))))}function f(){const{root:e}=Object(p.j)(),{help:t}=Object(O.useSelect)(e=>e(l.MODULES_STORE_NAME).getModule("user-groups")||{}),r=Object(a.useNavigateTo)(),s=Object(O.useRegistry)(),{applyDefaultGroupSettings:i,createDefaultGroups:n}=Object(O.useDispatch)("ithemes-security/user-groups-editor"),u=()=>{const t=s.select("ithemes-security/user-groups-editor").getMatchableNavIds();r(`/${e}/user-groups/${t[0]}`)};return Object(c.createElement)(React.Fragment,null,Object(c.createElement)(v,null),Object(c.createElement)(a.PageHeader,{title:Object(o.__)("User Groups","better-wp-security"),subtitle:Object(o.__)("User Groups allow you to enable security features for specific sets of users.","better-wp-security"),description:Object(o.__)("Default groups automatically categorize your users by their WordPress capabilities and enable the recommended security settings for each group. Alternatively, start from scratch with custom groups and categorize your users any way you like.","better-wp-security")+" "+Object(o.__)("User Groups won’t change a user’s capabilities, only iThemes Security features are impacted.","better-wp-security"),help:t}),Object(c.createElement)(h.p,{hasBorder:!0,recommended:!0,messages:Object(o.__)("Recommended: Default User Groups are the simplest way to get started with iThemes Security.","better-wp-security")}),Object(c.createElement)("div",{className:"itsec-user-groups-intro"},Object(c.createElement)(a.SelectableCard,{onClick:async()=>{await n(),await i(),u()},icon:"groups",title:Object(o.__)("Default","better-wp-security"),description:Object(o.__)("Continue with default groups","better-wp-security"),direction:"vertical",recommended:!0}),Object(c.createElement)(a.SelectableCard,{onClick:async()=>{await i(),u()},icon:"edit",title:Object(o.__)("Custom","better-wp-security"),description:Object(o.__)("Create custom groups","better-wp-security"),direction:"vertical"})))}function y(e){let{navIds:t,url:r,search:s,hash:i}=e;const n=Object(O.useSelect)(e=>t.map(e("ithemes-security/user-groups-editor").getEditedMatchableLabel),[t]),u=t.map((e,t)=>({title:n[t]||Object(o.__)("Untitled","better-wp-security"),to:`${r}/${e}${s}${i}`,id:e}));return Object(c.createElement)(a.ChildPages,{pages:u})}function _(e){let{root:t}=e;const{child:r}=Object(p.j)(),{previous:s,next:i,nextPage:n}=Object(a.useNavigation)();return Object(c.createElement)(React.Fragment,null,Object(c.createElement)(v,null),Object(c.createElement)(N,{groupId:r,showSave:"settings"===t}),"settings"!==t&&Object(c.createElement)(m.Flex,null,s&&Object(c.createElement)(m.FlexItem,null,Object(c.createElement)(b.a,{component:Object(j.i)(m.Button),isTertiary:!0,type:"button",to:s},Object(o.__)("Back","better-wp-security"))),Object(c.createElement)(h.j,null),i&&Object(c.createElement)(React.Fragment,null,Object(c.createElement)(m.FlexItem,null,Object(c.createElement)(b.a,{component:Object(j.i)(m.Button),isPrimary:!0,to:i},Object(o.__)("Next","better-wp-security"))),Object(c.createElement)(m.FlexItem,null,Object(c.createElement)(b.a,{component:Object(j.i)(m.Button),isPrimary:!0,to:n,text:Object(o.__)("Skip User Groups","better-wp-security"),icon:"arrow-right-alt",iconPosition:"right",className:"itsec-button-icon-right"})))))}function S(e){let{navIds:t}=e;const[r,s]=Object(g.d)("id",Object(g.e)(g.a,[])),[i,n]=Object(g.d)("all",g.b);return Object(c.useEffect)(()=>{i&&(s(t),n(void 0))},[s,i,n,t]),Object(c.createElement)(k,{groupIds:r})}function v(){const e=Object(p.k)(),{help:t}=Object(O.useSelect)(e=>e(l.MODULES_STORE_NAME).getModule("user-groups")||{});return Object(c.createElement)(a.HelpFill,null,Object(c.createElement)(a.PageHeader,{title:Object(o.__)("User Groups","better-wp-security"),description:t,breadcrumbs:Object(c.createElement)(a.Breadcrumbs,{title:Object(o.__)("Help","better-wp-security"),match:e})}),Object(c.createElement)(h.k,{topic:"user-groups"}))}var I=r("YLtl"),G=r("Mmq9"),L=r("TXkB");r("Y0od");function N(e){let{groupId:t,showSave:r}=e;const{hash:s,search:i}=Object(p.i)(),n=Object(G.getQueryArg)(i,"module"),{url:u,path:l}=Object(p.k)(),{type:a,isDirty:d,isSaving:b,notFound:g}=Object(O.useSelect)(e=>({type:e("ithemes-security/user-groups-editor").getMatchableType(t),isDirty:e("ithemes-security/user-groups-editor").isDirty(t),isSaving:e("ithemes-security/user-groups-editor").isSavingGroupOrSettings(t),notFound:e("ithemes-security/user-groups").isGroupNotFound(t)}),[t]),{saveGroupAndSettings:j,resetEdits:E}=Object(O.useDispatch)("ithemes-security/user-groups-editor"),f=Object(c.useMemo)(()=>[{name:"settings",title:Object(o.__)("Features","better-wp-security"),className:"itsec-manage-user-group-tabs__tab",Component:H},"user-group"===a&&{name:"edit",title:Object(o.__)("Edit Group","better-wp-security"),className:"itsec-manage-user-group-tabs__tab",Component:A}].filter(I.isPlainObject),[a]);return g?Object(c.createElement)(React.Fragment,null,Object(c.createElement)(h.p,{type:"error",title:Object(o.__)("No Group Found","better-wp-security"),messages:[Object(o.__)("No user group was found with the requested id.","better-wp-security")]}),Object(c.createElement)("div",{style:{maxWidth:"20rem",margin:"0 auto",display:"block"}},Object(c.createElement)(L.k,null))):Object(c.createElement)(React.Fragment,null,Object(c.createElement)(ie,{groupId:t,moduleFilter:n}),Object(c.createElement)(p.d,null,Object(c.createElement)(p.b,{path:l+"/:tab"},b?Object(c.createElement)(m.Disabled,null,Object(c.createElement)(R,{groupId:t,base:u,tabs:f,moduleFilter:n})):Object(c.createElement)(R,{groupId:t,base:u,tabs:f,highlight:s.substr(1),moduleFilter:n})),Object(c.createElement)(p.b,{path:l},Object(c.createElement)(p.a,{to:`${u}/${f[0].name}/${i}${s}`}))),r&&Object(c.createElement)(m.Flex,null,Object(c.createElement)(h.j,null),Object(c.createElement)(m.FlexItem,null,Object(c.createElement)(m.Button,{isSecondary:!0,onClick:()=>E(t),disabled:!d},Object(o.__)("Undo Changes","better-wp-security"))),Object(c.createElement)(m.FlexItem,null,Object(c.createElement)(m.Button,{isPrimary:!0,onClick:()=>j(t),isBusy:b,disabled:b||!d},Object(o.__)("Save","better-wp-security")))))}function R(e){let{groupId:t,base:r,tabs:s,highlight:i,moduleFilter:n}=e;const{url:u,params:{tab:l}}=Object(p.k)(),d=Object(a.useNavigateTo)(),g=Object(O.useSelect)(e=>e("ithemes-security/user-groups-editor").getError(t));return n?Object(c.createElement)(m.Card,null,Object(c.createElement)(m.CardHeader,{className:"itsec-user-groups-filtered-features"},Object(c.createElement)(b.a,{to:u,component:Object(j.i)(m.Button),icon:"arrow-left",text:Object(o.__)("All Features","better-wp-security"),isLink:!0})),Object(c.createElement)(H,{moduleFilter:n,groupId:t,highlight:i},Object(c.createElement)(h.i,{apiError:g}))):Object(c.createElement)(m.Card,null,Object(c.createElement)(h.g,{tabs:s,isStyled:!0,selected:l,onSelect:e=>{d(`${r}/${e}`,"replace")}},e=>{let{Component:r}=e;return Object(c.createElement)(r,{groupId:t,highlight:i},Object(c.createElement)(h.i,{apiError:g}))}))}function k(e){let{groupIds:t,showSave:r=!0}=e;const{isDirty:s,isSaving:i,errors:n}=Object(O.useSelect)(e=>({isDirty:e("ithemes-security/user-groups-editor").hasBulkSettingEdits(),isSaving:e("ithemes-security/user-groups-editor").isSavingBulkEdits(t),errors:e("ithemes-security/user-groups-editor").getBulkErrorsList()})),{saveBulkEdits:u,resetBulkGroupSettingEdits:l}=Object(O.useDispatch)("ithemes-security/user-groups-editor"),a=Object(c.useMemo)(()=>[{name:"settings",title:Object(o.__)("Features","better-wp-security"),className:"itsec-manage-user-group-tabs__tab",Component:W}]);return Object(c.createElement)(React.Fragment,null,Object(c.createElement)(ne,{groupIds:t}),Object(c.createElement)(m.Card,null,Object(c.createElement)(h.v,{tabs:a,isStyled:!0},e=>{let{Component:r}=e;return Object(c.createElement)(r,{groupIds:t},Object(c.createElement)(h.i,{errors:n}))})),r&&Object(c.createElement)(m.Flex,null,Object(c.createElement)(h.j,null),Object(c.createElement)(m.FlexItem,null,Object(c.createElement)(m.Button,{isSecondary:!0,onClick:()=>l(t),disabled:!s},Object(o.__)("Undo Changes","better-wp-security"))),Object(c.createElement)(m.FlexItem,null,Object(c.createElement)(m.Button,{isPrimary:!0,onClick:()=>u(t),isBusy:i,disabled:i||!s},Object(o.__)("Save","better-wp-security")))))}var T=r("K9lf");r("QmYb");var w=Object(T.compose)([Object(O.withSelect)((e,t)=>{let{groupId:r}=t;return{label:e("ithemes-security/user-groups-editor").getEditedGroupAttribute(r,"label")||""}}),Object(O.withDispatch)((e,t)=>{let{groupId:r}=t;return{edit:t=>e("ithemes-security/user-groups-editor").editGroup(r,t)}})])((function(e){let{label:t,edit:r,disabled:s=!1}=e;return Object(c.createElement)(m.TextControl,{label:Object(o.__)("Group Name","better-wp-security"),value:t,maxLength:50,disabled:s,onChange:e=>r({label:e})})})),D=r("TSYQ"),C=r.n(D);r("ZRc3");Object(T.compose)([Object(O.withSelect)(e=>({hasEdits:e("ithemes-security/user-groups-editor").hasEdits("new"),isSaving:e("ithemes-security/user-groups-editor").isCreating("new")})),Object(O.withDispatch)(e=>({save(){e("ithemes-security/user-groups-editor").createGroup()}}))])((function(e){let{hasEdits:t,save:r,isSaving:s}=e;return Object(c.createElement)(React.Fragment,null,Object(c.createElement)(m.CardBody,{className:"itsec-user-groups-group-tab__edit-fields"},Object(c.createElement)(ce,{groupId:"new"})),Object(c.createElement)(m.CardFooter,null,Object(c.createElement)(h.j,null),Object(c.createElement)(m.FlexItem,null,Object(c.createElement)(m.Button,{disabled:!t,isPrimary:!0,onClick:r,isBusy:s},Object(o.__)("Create","better-wp-security")))))}));var A=Object(T.compose)([Object(O.withSelect)((e,t)=>{let{groupId:r}=t;return{isLoading:e("core/data").isResolving("ithemes-security/user-groups","getGroup",[r])||e("core/data").isResolving("ithemes-security/core","getIndex")}})])((function(e){let{groupId:t,isLoading:r,children:s}=e;const i=Object(c.createElement)(React.Fragment,null,Object(c.createElement)(m.CardBody,{className:"itsec-user-groups-group-tab__edit-fields"},s,Object(c.createElement)(ce,{groupId:t,disabled:r})));return r?Object(c.createElement)(m.Disabled,null,i):i})),U=r("eDuk"),P=r.n(U),M=r("RUGT");function x(){return x.instance||(x.instance=new P.a({schemaId:"id"}),x.instance.addMetaSchema(r("3jBn"))),x.instance}function F(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=x();return Object(O.useSelect)(r=>r("ithemes-security/user-groups").getSettingDefinitions(t,e),[t,e])}function B(){const{registerCompletionStep:e}=Object(O.useDispatch)(a.ONBOARD_STORE_NAME),{saveGroups:t,saveGroupSettingsAsBatch:r}=Object(O.useDispatch)("ithemes-security/user-groups-editor");Object(j.f)(B,()=>{e({id:"savingUserGroups",label:Object(o.__)("Create User Groups","better-wp-security"),priority:15,callback:()=>t(),render:function(){const e=Object(O.useSelect)(e=>{const t=e("ithemes-security/user-groups-editor");return(t.getMatchableNavIds()||[]).map(e=>t.getEditedMatchableLabel(e))},[]);return e.length?Object(c.createElement)(React.Fragment,null,Object(c.createElement)("p",null,Object(o.__)("The following User Groups will be created:","better-wp-security")),Object(c.createElement)("ul",null,e.map((e,t)=>Object(c.createElement)("li",{key:t},e)))):Object(c.createElement)("p",null,Object(o.__)("No User Groups have been created.","better-wp-security"))}}),e({id:"savingUserGroupsSetting",label:Object(o.__)("Setup User Group Settings","better-wp-security"),priority:20,callback:()=>r(),render:function(){const e=F(),{ids:t,labels:r,settings:s}=Object(O.useSelect)(e=>{const t=e("ithemes-security/user-groups-editor"),r=t.getMatchableNavIds()||[];return{ids:r,labels:Object(I.zipObject)(r,r.map(e=>t.getEditedMatchableLabel(e))),settings:Object(I.zipObject)(r,r.map(e=>t.getEditedGroupSettings(e)))}},[]);return t.length?Object(c.createElement)(React.Fragment,null,Object(c.createElement)("p",null,Object(o.__)("The following features will be enabled for each User Group:","better-wp-security")),Object(c.createElement)("ul",{className:"itsec-secure-site-user-groups-settings-panel"},t.map(t=>{const i=e.flatMap(e=>{var r;return null!==(r=s[t])&&void 0!==r&&r[e.id]?Object(I.reduce)(e.settings,(r,i,n)=>(!0===s[t][e.id][n]&&r.push(i.title),r),[]):[]});return i.length?Object(c.createElement)("li",{key:t},Object(c.createElement)("strong",null,r[t]),Object(c.createElement)("ul",null,i.map((e,t)=>Object(c.createElement)("li",{key:t},e)))):Object(c.createElement)("li",{key:t},Object(o.sprintf)(Object(o.__)("%s: None","better-wp-security"),r[t]))}))):Object(c.createElement)("p",null,Object(o.__)("No User Groups have been created.","better-wp-security"))}})})}function $(){const{registerProvider:e}=Object(O.useDispatch)(M.a);Object(j.f)($,()=>{e("user-group-settings",Object(o.__)("User Group Settings","better-wp-security"),25,e=>{let{registry:t,evaluate:r,results:s}=e;return t.select("ithemes-security/user-groups").getSettingDefinitions(x()).reduce((e,t)=>Object(I.reduce)(t.settings,(e,i,n)=>{var c,o,u;return r.stringMatch(i.title)||r.stringMatch(i.description)||r.keywordMatch(i.keywords)?(null!==(u=(c=s.groups)[o=t.id])&&void 0!==u||(c[o]={title:t.title,items:[]}),s.groups[t.id].items.push({title:i.title,description:i.description,route:`/settings/user-groups?module=${t.id}#${t.id}/${n}`}),e++):e},e),0)}),e("user-groups",Object(o.__)("User Groups","better-wp-security"),50,e=>{let{registry:t,evaluate:r,results:s}=e;return(t.select("ithemes-security/user-groups-editor").getAvailableGroups()||[]).reduce((e,t)=>r.stringMatch(t.label)?(s.items.push({title:t.label,description:t.description,route:"/settings/user-groups/"+t.id}),e++):e,0)})})}var V=Object(T.compose)([Object(O.withSelect)((e,t)=>{let{groupId:r,module:s,setting:i}=t;return{value:e("ithemes-security/user-groups-editor").getEditedGroupSetting(r,s,i)}}),Object(O.withDispatch)((e,t)=>{let{groupId:r,module:s,setting:i}=t;return{edit:t=>e("ithemes-security/user-groups-editor").editGroupSetting(r,s,i,t)}})])((function(e){let{definition:t,value:r,edit:s,className:i,isHighlighted:n,disabled:o=!1}=e;return Object(c.createElement)(m.ToggleControl,{className:C()(i,{"itsec-highlighted-search-result":n}),checked:!0===r,label:t.title,help:t.description,disabled:o,onChange:e=>s(e)})}));r("GrEf");function H(e){let{groupId:t,highlight:r,moduleFilter:s,children:i}=e;const n=F({module:s}),{isLoading:o}=Object(O.useSelect)(e=>{let r=!1;if(!e("ithemes-security/user-groups-editor").isLocalGroup(t)){const s=e("ithemes-security/user-groups").getGroupSettings(t),i=e("ithemes-security/user-groups").isResolving("getGroupSettings",[t]);r=!s&&i}return{isLoading:r}},[t]);let u=Object(c.createElement)(m.CardBody,null,i,Object(c.createElement)(le,{definitions:n,settingComponent:V,groupId:t,disabled:o,highlight:r}));return o&&(u=Object(c.createElement)(m.Disabled,null,u)),Object(c.createElement)(React.Fragment,null,!s&&Object(c.createElement)(ae,null),u)}var K=Object(T.compose)([Object(O.withSelect)((e,t)=>{let{module:r,setting:s,groupIds:i}=t;return{value:e("ithemes-security/user-groups-editor").getBulkSettingValue(i,r,s)}}),Object(O.withDispatch)((e,t)=>{let{module:r,setting:s}=t;return{edit:t=>e("ithemes-security/user-groups-editor").bulkEditGroupSetting(r,s,t)}})])((function(e){let{definition:t,value:r,edit:s,disabled:i=!1}=e;return Object(c.createElement)(h.d,{checked:!0===r,indeterminate:null==r,label:t.title,help:t.description,disabled:i,onChange:e=>s(e)})}));function W(e){let{groupIds:t,children:r}=e;const s=F();let i=Object(c.createElement)(m.CardBody,null,r,Object(c.createElement)(le,{definitions:s,settingComponent:K,groupIds:t}));return t.length||(i=Object(c.createElement)(m.Disabled,null,i)),Object(c.createElement)(React.Fragment,null,Object(c.createElement)(ae,null),i)}Object(T.compose)([Object(O.withSelect)((e,t)=>{let{groupId:r}=t;return{minRole:e("ithemes-security/user-groups-editor").getEditedGroupAttribute(r,"min_role")}}),Object(O.withDispatch)((e,t)=>{let{groupId:r}=t;return{onChange:t=>e("ithemes-security/user-groups-editor").editGroup(r,t)}})])((function(e){let{minRole:t,onChange:r}=e;return Object(c.createElement)("div",null,Object(c.createElement)(m.SelectControl,{options:[{value:"administrator",label:Object(o._x)("Administrator","User role")},{value:"editor",label:Object(o._x)("Editor","User role")},{value:"author",label:Object(o._x)("Author","User role")},{value:"contributor",label:Object(o._x)("Contributor","User role")},{value:"subscriber",label:Object(o._x)("Subscriber","User role")}],label:Object(o.__)("Minimum Role","better-wp-security"),value:t,onChange:e=>r({min_role:e}),help:Object(o.__)("Add users with the selected minimum role to this group. To edit roles, go to Users in your WordPress Dashboard.","better-wp-security")}))}));var q=r("4eJC"),Y=r.n(q),z=r("Td6G");const X=Y()((e,t)=>{const r=[{value:"$administrator$",label:Object(o.__)("Administrator Capabilities","better-wp-security")},{value:"$editor$",label:Object(o.__)("Editor Capabilities","better-wp-security")},{value:"$author$",label:Object(o.__)("Author Capabilities","better-wp-security")},{value:"$contributor$",label:Object(o.__)("Contributor Capabilities","better-wp-security")},{value:"$subscriber$",label:Object(o.__)("Subscriber Capabilities","better-wp-security")}];t&&r.unshift({value:"$super-admin$",label:Object(o.__)("Super Admin","better-wp-security")}),Object(I.some)(e,e=>""===e.canonical)&&r.push({value:"$other$",label:Object(o.__)("Other","better-wp-security"),selectable:!1});for(const t in e){if(!e.hasOwnProperty(t))continue;const{canonical:s,label:i}=e[t];r.push({value:t,parent:s.length>0?`$${s}$`:"$other$",label:i})}return Object.values(r)});var Z=Object(T.compose)([Object(O.withSelect)((e,t)=>{let{groupId:r}=t;return{roles:e("ithemes-security/user-groups-editor").getEditedGroupAttribute(r,"roles")||[],canonical:e("ithemes-security/user-groups-editor").getEditedGroupAttribute(r,"canonical")||[],available:e("ithemes-security/core").getRoles(),schema:e("ithemes-security/core").getSchema("ithemes-security-user-group")}}),Object(O.withDispatch)((e,t)=>{let{groupId:r}=t;return{onChange:t=>e("ithemes-security/user-groups-editor").editGroup(r,t)}})])((function(e){let{canonical:t,roles:r,onChange:s,available:i,schema:n,disabled:u=!1}=e;const l=Object(I.get)(n,["properties","canonical","items","enum"],[]).includes("super-admin"),a=[...r,...t.map(e=>`$${e}$`)];return Object(c.createElement)(h.m,{label:Object(o.__)("Select Roles","better-wp-security"),help:Object(o.__)("Add users with the selected roles to this group.","better-wp-security"),value:a,disabled:u,options:X(i,l),onChange:e=>{const[t,r]=Object(z.d)(e,e=>e.startsWith("$")&&e.endsWith("$"));s({roles:r,canonical:Object(I.without)(t.map(e=>e.slice(1,-1)),"other")})}})})),Q=r("ywyh"),J=r.n(Q);r("ELjz");function ee(e){return{value:e.id,label:e.name,user:e}}const te=e=>new Promise((t,r)=>{J()({path:Object(G.addQueryArgs)("/wp/v2/users",{search:e,per_page:100,context:"embed",itsec_global:!0})}).then(e=>(e.forEach(Object(O.dispatch)("ithemes-security/core").receiveUser),e)).then(e=>t(e.map(ee))).catch(r)});var re=Object(T.compose)([Object(O.withSelect)((e,t)=>{let{groupId:r}=t;const s=e("ithemes-security/user-groups-editor").getEditedGroupAttribute(r,"users")||[],i=[];let n=!1;return s.forEach(t=>{const r=e("ithemes-security/core").getUser(t);r?i.push(r):e("core/data").isResolving("ithemes-security/core","getUser",[t])&&(n=!0)}),{users:i,userIds:s,loading:n}}),Object(O.withDispatch)((e,t)=>{let{groupId:r}=t;return{receiveUser:e("ithemes-security/core").receiveUser,onChange:t=>e("ithemes-security/user-groups-editor").editGroup(r,t)}}),T.withInstanceId])((function(e){let{instanceId:t,users:r,loading:s,onChange:i,disabled:n=!1}=e;const[u,l]=Object(c.useState)(""),a="itsec-user-group-panel-users__select-"+t,d=s?[]:r.map(ee);return Object(c.createElement)(m.BaseControl,{className:"itsec-user-group-panel-users__select-control",label:Object(o.__)("Select Users","better-wp-security"),help:Object(o.__)("Select specific users to add to this group.","better-wp-security"),id:a},Object(c.createElement)(h.c,{classNamePrefix:"components-itsec-async-select-control",inputId:a,isDisabled:n||s,isLoading:s,isMulti:!0,cacheOptions:!0,defaultOptions:!0,loadOptions:te,value:d,onChange:e=>i({users:Object(I.map)(e,"value")}),inputValue:u,onInputChange:e=>l(e)}))})),se=r("LhCv");function ie(e){let{groupId:t,moduleFilter:r}=e;const{root:s}=Object(p.j)(),i=Object(p.i)(),{type:n,isDeleting:u,label:l,navIds:d,help:b,module:g}=Object(O.useSelect)(e=>{var s;return{type:e("ithemes-security/user-groups-editor").getMatchableType(t),isDeleting:e("ithemes-security/user-groups").isDeleting(t),label:e("ithemes-security/user-groups-editor").getEditedMatchableLabel(t),navIds:e("ithemes-security/user-groups-editor").getMatchableNavIds(),help:null===(s=e("ithemes-security/modules").getModule("user-groups"))||void 0===s?void 0:s.help,module:e("ithemes-security/modules").getModule(r)}},[t,r]),{deleteGroup:h}=Object(O.useDispatch)("ithemes-security/user-groups-editor"),j=Object(a.useNavigateTo)(),E=l||Object(o.__)("Untitled","better-wp-security"),f=Object(a.useBreadcrumbTrail)((null==g?void 0:g.label)||E),y="user-group"===n;return Object(c.createElement)(a.PageHeader,{title:E,help:b,breadcrumbs:Object(c.createElement)(a.Breadcrumbs,{trail:Object(c.useMemo)(()=>[...f,g&&{to:Object(se.e)(i),title:g.title}].filter(I.identity),[f,g])})},y&&Object(c.createElement)(m.Button,{onClick:async()=>{if(!(await h(t)instanceof Error)){let e;const r=d.findIndex(e=>e===t);-1!==r&&(e=r+1<d.length?r+1:r-1),j(`/${s}/user-groups/${d[e]||""}`)}},isBusy:u,isLink:!0,isDestructive:!0},Object(o.__)("Delete Group","better-wp-security")))}Object(T.compose)([Object(O.withSelect)(e=>({label:e("ithemes-security/user-groups-editor").getEditedGroupAttribute("new","label")}))])((function(e){let{label:t}=e;return t&&t.length||(t=Object(o.__)("New Group","better-wp-security")),Object(c.createElement)(a.PageHeader,{label:t})}));function ne(e){let{groupIds:t}=e;const r=Object(O.useSelect)(e=>t.map(e("ithemes-security/user-groups-editor").getEditedMatchableLabel).join(", "),[t]);return Object(c.createElement)(a.PageHeader,{title:r||Object(o.__)("Select Groups","better-wp-security")})}r("XO7p");var ce=function(e){let{groupId:t,disabled:r}=e;return Object(c.createElement)(React.Fragment,null,Object(c.createElement)(w,{groupId:t,disabled:r}),Object(c.createElement)(Z,{groupId:t,disabled:r}),Object(c.createElement)(re,{groupId:t,disabled:r}))},oe=r("pVnL"),ue=r.n(oe);function le(e){let{highlight:t,definitions:r,settingComponent:s,...i}=e;const[n,o]=(t||"").split("/");return Object(c.createElement)("form",null,Object(c.createElement)("ul",{className:"itsec-user-groups-group-tab__modules-list"},Object(I.map)(r,e=>!Object(I.isEmpty)(e.settings)&&Object(c.createElement)("li",{key:e.id,className:"itsec-user-groups-group-tab_settings-list"},Object(c.createElement)("h3",null,e.title),Object(I.map)(e.settings,(t,r)=>Object(c.createElement)(s,ue()({key:r,definition:t,module:e.id,setting:r,isHighlighted:e.id===n&&r===o},i)))))))}r("TMLI");function ae(){const[e,t]=Object(g.d)("id",Object(g.e)(g.a,[])),[r]=Object(g.d)("back"),{root:s,child:i}=Object(p.j)(),n=Object(a.useNavigateTo)(),{matchables:u,isLocal:l}=Object(O.useSelect)(e=>({matchables:e("ithemes-security/user-groups").getMatchables()||[],isLocal:i&&e("ithemes-security/user-groups-editor").isLocalGroup(i)}),[i]);if("settings"!==s)return null;let d=Object(o.__)("Select multiple User Groups to edit together.","better-wp-security");return l&&(d=Object(c.createElement)(React.Fragment,null,d,Object(c.createElement)(h.l,{help:Object(o.__)("Save the User Group first to enable multi-editing.","better-wp-security")}))),Object(c.createElement)("div",{className:"itsec-user-groups-multi-group-selector"},Object(c.createElement)(m.CheckboxControl,{label:d,onChange:e=>{n(e?`/${s}/user-groups/multi?id=${i}&back=${i}`:r?`/${s}/user-groups/${r}`:`/${s}/user-groups`,"replace")},checked:!i,disabled:l}),!i&&Object(c.createElement)("fieldset",null,Object(c.createElement)(m.VisuallyHidden,{as:"legend"},Object(o.__)("User Groups","better-wp-security")),Object(c.createElement)(h.f,{label:Object(o.__)("Select All","better-wp-security"),checked:e.length===u.length,onChange:e=>{t(e?u.map(e=>e.id):[])},className:"itsec-user-groups-multi-group-selector__select-all"}),u.map(r=>Object(c.createElement)(de,{key:r.id,id:r.id,selected:e,setSelected:t}))))}function de(e){let{id:t,selected:r,setSelected:s}=e;const{label:i}=Object(O.useSelect)(e=>({label:e("ithemes-security/user-groups-editor").getEditedMatchableLabel(t)}),[t]);return Object(c.createElement)(h.f,{label:i,checked:r.includes(t),onChange:e=>{s(e?[...r,t]:Object(I.without)(r,t),"replaceIn")}})}function pe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"info",t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return{type:"CREATE_NOTICE",status:e,content:t,options:{context:"ithemes-security",...r}}}var be,ge={API_FETCH(e){let{request:t}=e;return J()(t).catch(z.l)},SELECT(e){let{storeKey:t,selectorName:r,args:s}=e;return Object(O.select)(t)[r](...s)},DISPATCH(e){let{storeKey:t,actionName:r,args:s}=e;return Object(O.dispatch)(t)[r](...s)},CREATE_NOTICE(e){let{status:t,content:r,options:s}=e;s.autoDismiss&&(s.id=s.id||Object(I.uniqueId)("itsec-auto-dismiss-"),setTimeout(()=>Object(O.dispatch)("core/notices").removeNotice(s.id,s.context),s.autoDismiss)),Object(O.dispatch)("core/notices").createNotice(t,r,s)}},Oe=new Uint8Array(16);function me(){if(!be&&!(be="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return be(Oe)}var he=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var je=function(e){return"string"==typeof e&&he.test(e)},Ee=[],fe=0;fe<256;++fe)Ee.push((fe+256).toString(16).substr(1));var ye=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(Ee[e[t+0]]+Ee[e[t+1]]+Ee[e[t+2]]+Ee[e[t+3]]+"-"+Ee[e[t+4]]+Ee[e[t+5]]+"-"+Ee[e[t+6]]+Ee[e[t+7]]+"-"+Ee[e[t+8]]+Ee[e[t+9]]+"-"+Ee[e[t+10]]+Ee[e[t+11]]+Ee[e[t+12]]+Ee[e[t+13]]+Ee[e[t+14]]+Ee[e[t+15]]).toLowerCase();if(!je(r))throw TypeError("Stringified UUID is invalid");return r};var _e=function(e,t,r){var s=(e=e||{}).random||(e.rng||me)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){r=r||0;for(var i=0;i<16;++i)t[r+i]=s[i];return t}return ye(s)};function*Se(e,t){const r=!(yield O.controls.select("ithemes-security/user-groups-editor","isLocalGroup",e))&&(yield O.controls.select("ithemes-security/user-groups","getGroup",e)),s={...(yield O.controls.select("ithemes-security/user-groups-editor","getEditedGroup",e))||{},...t},i=Object(I.pickBy)(s,(e,t)=>!Object(I.isEqual)(null==r?void 0:r[t],e));yield{type:He,id:e,edit:i}}function*ve(e){const t=yield O.controls.select("ithemes-security/user-groups-editor","getEditedGroup",e);if(!t)return;let r;return yield{type:Ze,id:e},r=(yield O.controls.select("ithemes-security/user-groups-editor","isLocalGroup",e))?yield O.controls.dispatch("ithemes-security/user-groups","createGroup",{...t,id:e}):yield O.controls.dispatch("ithemes-security/user-groups","updateGroup",e,t),r instanceof Error?yield{type:Je,id:e,error:r}:(yield{type:Qe,id:e,updated:r},yield pe("success",Object(o.__)("Saved group.","better-wp-security"),{type:"snackbar"})),r}function*Ie(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=yield O.controls.select("ithemes-security/user-groups-editor","getLocalGroupIds"),r=yield O.controls.select("ithemes-security/user-groups-editor","getGroupsMarkedForDeletion");if(!0===e?e=[...new Set([...yield O.controls.select("ithemes-security/user-groups-editor","getDirtyGroups"),...t,...r])]:Object(I.isString)(e)&&(e=[e]),!e.length)return[];const s=[],i=[],n=[];for(const c of e){const e=yield O.controls.select("ithemes-security/user-groups-editor","getEditedGroup",c);r.includes(c)?n.push(c):t.includes(c)?i.push({...e,id:c}):s.push({...e,id:c})}const c=yield O.controls.dispatch("ithemes-security/user-groups","saveGroups",{create:i,update:s,delete:n});if(c instanceof Error)return yield pe("error",Object(o.sprintf)(Object(o.__)("Could not save user groups: %s","better-wp-security"),c.message)),c;for(const[e,t]of Object.entries(c.byId))t.status>=400?yield{type:Je,id:e,error:t.body}:yield{type:Qe,id:e,updated:t.body};return yield pe("success",Object(o.__)("Saved user groups.","better-wp-security"),{type:"snackbar"}),c}function Ge(e){return{type:Ke,id:e}}function Le(){return{type:We}}function Ne(e){return{type:Xe,id:e}}function*Re(e){if(yield O.controls.select("ithemes-security/user-groups-editor","isLocalGroup",e))yield{type:Ye,id:e};else{const t=yield O.controls.dispatch("ithemes-security/user-groups","deleteGroup",e);if(t instanceof Error)return yield{type:$e,id:e,error:t},t}yield Ge(e),yield{type:$e,id:e,error:null}}function ke(){return{type:ze}}function Te(e){return{type:qe,id:e||_e()}}function*we(e,t,r,s){const i=!(yield O.controls.select("ithemes-security/user-groups-editor","isLocalGroup",e))&&(yield O.controls.select("ithemes-security/user-groups","getGroupSetting",e,t,r));Object(I.isEqual)(i,s)?yield{type:tt,id:e,module:t,setting:r}:yield{type:et,id:e,module:t,setting:r,value:s}}function*De(e){const t=yield O.controls.select("ithemes-security/user-groups-editor","getGroupSettingsEdits",e);if(!t)return;yield{type:rt,id:e};const r=yield O.controls.dispatch("ithemes-security/user-groups","updateGroupSettings",e,t);return r instanceof Error?yield{type:it,id:e,error:r}:(yield{type:st,id:e,updated:r},yield pe("success",Object(o.__)("Updated group settings.","better-wp-security"),{type:"snackbar"})),r}function*Ce(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===e?e=yield O.controls.select("ithemes-security/user-groups-editor","getDirtyGroupSettings"):Object(I.isString)(e)&&(e=[e]),!e.length)return{responses:[],byId:{}};const t={};for(const r of e)t[r]=yield O.controls.select("ithemes-security/user-groups-editor","getGroupSettingsEdits",r);const r=yield O.controls.dispatch("ithemes-security/user-groups","saveGroupSettingsAsBatch",t);if(r instanceof Error)return yield pe("error",Object(o.sprintf)(Object(o.__)("Could not save user groups: %s","better-wp-security"),r.message)),r;for(const[e,t]of Object.entries(r.byId))t.status>=400?yield{type:it,id:e,error:t.body}:yield{type:st,id:e,updated:t.body};return yield pe("success",Object(o.__)("Saved user groups.","better-wp-security"),{type:"snackbar"}),r}function Ae(e,t,r){return{type:nt,module:e,setting:t,value:r}}function Ue(e,t){return{type:ct,module:e,setting:t}}function Pe(){return{type:ot}}function*Me(e){const t=yield O.controls.select("ithemes-security/user-groups-editor","getBulkSettingEdits"),r=yield O.controls.dispatch("ithemes-security/user-groups","patchBulkGroupSettings",e,t);if(r instanceof Error)yield pe("error",r.message);else if(Object(I.map)(r,"status").every(e=>200===e))yield pe("success",Object(o.__)("Updated group settings.","better-wp-security"),{type:"snackbar"});else{const e=r.filter(e=>{let{status:t}=e;return 200!==t}).flatMap(e=>{let{error:t}=e;return Object(z.e)(t).getAllErrorMessages()});yield{type:Ve,errors:e}}return yield Pe(),r}function*xe(e){if(yield O.controls.select("ithemes-security/user-groups-editor","hasEdits",e)){const t=yield*ve(e);if(t instanceof Error)return t}if(yield O.controls.select("ithemes-security/user-groups-editor","settingHasEdits",e)){const t=yield*De(e);if(t instanceof Error)return t}return null}function*Fe(){const e=yield O.controls.resolveSelect(l.MODULES_STORE_NAME,"getEditedModules"),t=yield O.controls.select("ithemes-security/user-groups-editor","getMatchableNavIds");for(const r of t)for(const t of e)if("active"===t.status.selected)for(const e in t.user_groups)t.user_groups.hasOwnProperty(e)&&"all"===t.user_groups[e].default&&(yield we(r,t.id,e,!0))}function*Be(){const e={administrator:Object(o.__)("Administrators","better-wp-security"),editor:Object(o.__)("Editors","better-wp-security"),author:Object(o.__)("Authors","better-wp-security"),contributor:Object(o.__)("Contributors","better-wp-security"),subscriber:Object(o.__)("Subscribers","better-wp-security")},t=yield O.controls.resolveSelect(l.MODULES_STORE_NAME,"getEditedModules"),r=yield O.controls.resolveSelect("ithemes-security/user-groups","getMatchables"),s=yield O.controls.select("ithemes-security/user-groups-editor","getLocalGroupIds"),i=yield O.controls.select(a.ONBOARD_STORE_NAME,"getAnswers"),n={administrator:[],editor:[],author:[],contributor:[],subscriber:[]};for(const e of Object(I.map)(Object(I.filter)(r,{type:"user-group"}),"id").concat(s)){const t=yield O.controls.select("ithemes-security/user-groups-editor","getEditedGroupAttribute",e,"canonical");for(const r of t)n[r].push(e)}const c={};for(const e of i)Object(I.isPlainObject)(e.canonical_group_substitutions)&&Object.assign(c,e.canonical_group_substitutions);for(const r in e){if(!e.hasOwnProperty(r))continue;const s=n[r];if(c.hasOwnProperty(r)){if(null===c[r]&&!s.length)continue;s.push(c[r])}if(0===s.length){const t=_e();yield Te(t),yield Se(t,{label:e[r],canonical:[r]}),s.push(t)}"subscriber"===r&&s.push("everybody-else");for(const e of t)if("active"===e.status.selected)for(const t in e.user_groups){if(!e.user_groups.hasOwnProperty(t))continue;if(!e.user_groups[t].default)continue;let i=e.user_groups[t].default;if(Array.isArray(i)||(i=[i]),Object(I.intersection)(["all",r],i).length>0)for(const r of s)yield we(r,e.id,t,!0)}for(const e of i)if(e.user_groups_settings[r])for(const t in e.user_groups_settings[r])if(e.user_groups_settings[r].hasOwnProperty(t))for(const i of e.user_groups_settings[r][t])for(const e of s)yield we(e,t,i,!0)}return yield O.controls.select("ithemes-security/user-groups-editor","getMatchableNavIds")}const $e="SET_GROUP_ERROR",Ve="SET_BULK_ERRORS",He="EDIT_GROUP",Ke="RESET_EDITS",We="RESET_ALL_EDITS",qe="CREATE_LOCAL_GROUP",Ye="DELETE_LOCAL_GROUP",ze="DELETE_LOCAL_GROUPS",Xe="MARK_GROUP_FOR_DELETION",Ze="START_SAVE_GROUP",Qe="FINISH_SAVE_GROUP",Je="FAILED_SAVE_GROUP",et="EDIT_GROUP_SETTING",tt="RESET_GROUP_SETTING",rt="START_SAVE_GROUP_SETTINGS",st="FINISH_SAVE_GROUP_SETTINGS",it="FAILED_SAVE_GROUP_SETTINGS",nt="BULK_EDIT_GROUP_SETTING",ct="RESET_BULK_GROUP_SETTING_EDIT",ot="RESET_BULK_GROUP_SETTING_EDITS";var ut=r("pPDe");function lt(e){return e.localGroupIds}function at(e,t){return e.localGroupIds.includes(t)}const dt=Object(O.createRegistrySelector)(e=>(t,r)=>at(t,r)?"user-group":e("ithemes-security/user-groups").getMatchableType(r)),pt=Object(O.createRegistrySelector)(e=>(t,r)=>t.saving.includes(r)||e("ithemes-security/user-groups").isUpdating(r)||e("ithemes-security/user-groups").isUpdatingSettings(r));function bt(e,t){return e.edits[t]}const gt=Object(O.createRegistrySelector)(e=>(t,r,s)=>{const i=Object(I.get)(t,["edits",r,s]);return void 0!==i?i:"new"===r||at(t,r)?void 0:e("ithemes-security/user-groups").getGroupAttribute(r,s)}),Ot=Object(O.createRegistrySelector)(e=>(t,r)=>"user-group"!==e("ithemes-security/user-groups-editor").getMatchableType(r)?e("ithemes-security/user-groups").getMatchableLabel(r):e("ithemes-security/user-groups-editor").getEditedGroupAttribute(r,"label"));function mt(e,t){return e.edits[t]&&!Object(I.isEmpty)(e.edits[t])}const ht=Object(ut.a)(e=>Object.keys(e.edits).filter(t=>!Object(I.isEmpty)(e.edits[t])),e=>e.edits);function jt(e,t){return!!e.settingEdits[t]}function Et(e,t){return e.settingEdits[t]}const ft=Y()((e,t)=>Object(I.merge)({},e,t),{maxSize:1}),yt=Object(O.createRegistrySelector)(e=>(t,r)=>{const s=at(t,r)?{}:e("ithemes-security/user-groups").getGroupSettings(r),i=Et(t,r);return ft(s,i)}),_t=Object(O.createRegistrySelector)(e=>(t,r,s,i)=>{const n=Object(I.get)(t,["settingEdits",r,s,i]);return void 0!==n?n:!at(t,r)&&e("ithemes-security/user-groups").getGroupSetting(r,s,i)}),St=Object(O.createRegistrySelector)(e=>t=>{const r=e("ithemes-security/user-groups").getGroupsBySetting();if(Object(I.isEmpty)(t.settingEdits)||Object(I.isEmpty)(r))return r;const s=Object(I.cloneDeep)(r);for(const[e,r]of Object.entries(t.settingEdits))for(const[t,n]of Object.entries(r))for(const[r,c]of Object.entries(n)){var i;null!==(i=s[t])&&void 0!==i&&i[r]&&(c?s[t][r].push(e):Object(I.pull)(s[t][r],e))}return s}),vt=Object(ut.a)(e=>Object.keys(e.settingEdits).filter(t=>!Object(I.isEmpty)(e.settingEdits[t])),e=>e.settingEdits);function It(e,t){return mt(e,t)||jt(e,t)}function Gt(e){return!Object(I.isEmpty)(e.bulkSettingEdits)}function Lt(e){return e.bulkSettingEdits}function Nt(e,t,r){return Object(I.get)(e,["bulkSettingEdits",t,r])}const Rt=Object(O.createRegistrySelector)(e=>(t,r,s,i)=>{const n=Nt(t,s,i);if(void 0!==n)return n;const c=t=>e("ithemes-security/user-groups").getGroupSetting(t,s,i),o=c(r[0]);return r.every(e=>c(e)===o)?o:null}),kt=Object(O.createRegistrySelector)(e=>(t,r)=>{const s=Lt(t);return e("ithemes-security/user-groups").isBulkPatchingSettings(r,s)}),Tt=Object(O.createRegistrySelector)(e=>()=>e("ithemes-security/user-groups").getGroups("available")),wt=Y()((e,t,r,s)=>{if(t&&!e.length)return null;const[i,n]=Object(I.partition)(e,e=>"user-group"===e.type);return i.map(e=>e.id).concat(r).concat(n.map(e=>e.id)).filter(e=>!s.includes(e))},{maxSize:1}),Dt=Object(O.createRegistrySelector)(e=>()=>{const t=e("ithemes-security/user-groups").getMatchables(),r=e("core/data").isResolving("ithemes-security/user-groups","getMatchables"),s=e("ithemes-security/user-groups-editor").getLocalGroupIds(),i=e("ithemes-security/user-groups-editor").getGroupsMarkedForDeletion();return wt(t,r,s,i)});function Ct(e){return e.markedForDelete}function At(e,t){return e.errors[t]}function Ut(e){return e.bulkErrors}function*Pt(){yield function(e,t){for(var r=arguments.length,s=new Array(r>2?r-2:0),i=2;i<r;i++)s[i-2]=arguments[i];return{type:"DISPATCH",storeKey:e,actionName:t,args:s}}("ithemes-security/user-groups","query","available",{_embed:1})}const Mt={edits:{},settingEdits:{},bulkSettingEdits:{},localGroupIds:[],saving:[],errors:{},bulkErrors:[],markedForDelete:[]};Object(O.registerStore)("ithemes-security/user-groups-editor",{controls:ge,actions:s,selectors:i,resolvers:n,reducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Mt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case He:return{...e,edits:{...e.edits,[t.id]:t.edit}};case qe:return{...e,localGroupIds:[...e.localGroupIds,t.id]};case Ye:return{...e,localGroupIds:e.localGroupIds.filter(e=>e!==t.id)};case ze:return{...e,localGroupIds:[]};case Ze:return{...e,saving:[...e.saving,t.id]};case Je:return{...e,saving:e.saving.filter(e=>e!==t.id),errors:{...e.errors,[t.id]:t.error}};case Qe:return{...e,edits:Object(I.omit)(e.edits,[t.id]),localGroupIds:e.localGroupIds.filter(e=>e!==t.id),saving:e.saving.filter(e=>e!==t.id),errors:Object(I.omit)(e.errors,[t.id])};case et:return{...e,settingEdits:{...e.settingEdits,[t.id]:{...Object(I.get)(e,["settingEdits",t.id],{}),[t.module]:{...Object(I.get)(e,["settingEdits",t.id,t.module],{}),[t.setting]:t.value}}}};case tt:const r={...e,settingEdits:{...e.settingEdits,[t.id]:{...Object(I.get)(e,["settingEdits",t.id],{}),[t.module]:Object(I.omit)(Object(I.get)(e,["settingEdits",t.id,t.module],{}),[t.setting])}}};return Object(I.isEmpty)(r.settingEdits[t.id][t.module])&&delete r.settingEdits[t.id][t.module],Object(I.isEmpty)(r.settingEdits[t.id])&&delete r.settingEdits[t.id],r;case st:return{...e,settingEdits:Object(I.omit)(e.settingEdits,[t.id]),errors:Object(I.omit)(e.errors,[t.id])};case it:return{...e,errors:{...e.errors,[t.id]:t.error}};case Ke:return{...e,edits:Object(I.omit)(e.edits,[t.id]),settingEdits:Object(I.omit)(e.settingEdits,[t.id]),markedForDelete:e.markedForDelete.filter(e=>e!==t.id),localGroupIds:e.localGroupIds.filter(e=>e!==t.id)};case We:return{...e,edits:{},settingEdits:{},bulkSettingEdits:{},markedForDelete:[],localGroupIds:[]};case nt:return{...e,bulkSettingEdits:{...e.bulkSettingEdits,[t.module]:{...e.bulkSettingEdits[t.module]||{},[t.setting]:t.value}}};case ct:return{...e,bulkSettingEdits:Object(I.omit)(e.bulkSettingEdits,`${t.module}.${t.setting}`)};case ot:return{...e,bulkSettingEdits:{}};case Xe:return{...e,markedForDelete:[...e.markedForDelete,t.id]};case $e:return{...e,errors:t.error?{...e.errors,[t.id]:t.error}:Object(I.omit)(e.errors,[t.id])};case Ve:return{...e,bulkErrors:t.errors};default:return e}},persist:["edits","settingEdits","bulkSettingEdits","localGroupIds","markedForDelete"]});var xt=r("g56x");Object(xt.addAction)("ithemes-security.onboard.applyAnswerResponse","ithemes-security/user-groups/onboard.applyAnswerResponse",(function(e,t){for(const r of t.user_groups){e.dispatch("ithemes-security/user-groups-editor").createLocalGroup(r.id)&&e.dispatch("ithemes-security/user-groups-editor").editGroup(r.id,Object(I.pick)(r,["label","users","roles","canonical"]))}for(const r in t.user_groups_settings){if(!t.user_groups_settings.hasOwnProperty(r)||!je(r))continue;const s=t.user_groups_settings[r];if(s)for(const t in s)if(s.hasOwnProperty(t))for(const i of s[t])e.dispatch("ithemes-security/user-groups-editor").editGroupSetting(r,t,i,!0)}})),Object(xt.addAction)("ithemes-security.onboard.reset","ithemes-security/user-groups/onboard.reset",(function(e){e.dispatch("ithemes-security/user-groups-editor").deleteLocalGroups(),e.dispatch("ithemes-security/user-groups-editor").resetAllEdits()})),Object(xt.addFilter)("ithemes-security.settings.isConditionalSettingActive","ithemes-security/user-groups/user-group-conditional",(function(e,t,r,s){if(!e||!r["user-groups"])return e;const{registry:i}=s,n=i.select("ithemes-security/user-groups-editor").getEditedGroupsBySetting();for(const e of r["user-groups"]){var c;if(!((null===(c=n[t.id])||void 0===c?void 0:c[e])||[]).length)return!1}return!0}));r("wM0a");function Ft(){return B(),$(),Object(c.createElement)(a.Page,{id:"user-groups",title:Object(o.__)("User Groups","better-wp-security"),icon:"groups",priority:10,roots:["onboard","settings","import"]},()=>Object(c.createElement)(d,null))}r.p=window.itsecWebpackPublicPath,Object(o.setLocaleData)({"":{}},"ithemes-security-pro"),Object(u.registerPlugin)("itsec-user-groups",{render:()=>Object(c.createElement)(Ft,null)})},faye:function(e,t){!function(){e.exports=this.ReactDOM}()},g56x:function(e,t){!function(){e.exports=this.wp.hooks}()},gdqT:function(e,t){!function(){e.exports=this.wp.a11y}()},l3Sj:function(e,t){!function(){e.exports=this.wp.i18n}()},on51:function(e,t){!function(){e.exports=this.itsec.pages.settings}()},onLe:function(e,t){!function(){e.exports=this.wp.notices}()},rl8x:function(e,t){!function(){e.exports=this.wp.isShallowEqual}()},sPxh:function(e,t){!function(){e.exports=this.itsec["user-groups"].api}()},"tI+e":function(e,t){!function(){e.exports=this.wp.components}()},wM0a:function(e,t,r){},ywyh:function(e,t){!function(){e.exports=this.wp.apiFetch}()},z1rk:function(e,t){!function(){e.exports=this.itsec.packages.data}()}},[["epig",0,4,1,2,6,7,3,5]]]);